\hypertarget{classmdt_port_lock}{
\section{mdtPortLock Class Reference}
\label{classmdt_port_lock}\index{mdtPortLock@{mdtPortLock}}
}


NOTE:  




{\ttfamily \#include $<$mdtPortLock.h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classmdt_port_lock_a25e9a2cb8a10069fae75c76b6809c27f}{openLocked} (const QString \&portName, int flags)
\begin{DoxyCompactList}\small\item\em Open a port locked. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_lock_a60b65f02d57568dc36c5e918aa5357a6}{unlock} ()
\begin{DoxyCompactList}\small\item\em Unlock the port. \end{DoxyCompactList}\item 
\hypertarget{classmdt_port_lock_a07a7d13509147d65dde89e95ac343eb2}{
bool \hyperlink{classmdt_port_lock_a07a7d13509147d65dde89e95ac343eb2}{isLocked} ()}
\label{classmdt_port_lock_a07a7d13509147d65dde89e95ac343eb2}

\begin{DoxyCompactList}\small\item\em Returns true if port is locked by current instance. \end{DoxyCompactList}\item 
\hypertarget{classmdt_port_lock_a739a8cedebb1a32e122c7e451f0cfe98}{
bool \hyperlink{classmdt_port_lock_a739a8cedebb1a32e122c7e451f0cfe98}{isLockedByAnother} ()}
\label{classmdt_port_lock_a739a8cedebb1a32e122c7e451f0cfe98}

\begin{DoxyCompactList}\small\item\em Returns true if port is locked by another instance. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
NOTE: 

\begin{Desc}
\item[\hyperlink{todo__todo000014}{Todo}]Implement UUCP format in LCK.. files \end{Desc}


Open a port and lock it

On Linux (or all POSIX ?) system, file locking is avaliable with fcntl(). But several applications uses LCK..name for locking.

This class will try to find if a port is allready locked using LCK..name system in several directories (/var/lock, /tmp, ...).

If nothing is found, then port will be opened, and several lockfiles created. The port is then locked with fcntl(). 

Definition at line 45 of file mdtPortLock.h.



\subsection{Member Function Documentation}
\hypertarget{classmdt_port_lock_a25e9a2cb8a10069fae75c76b6809c27f}{
\index{mdtPortLock@{mdtPortLock}!openLocked@{openLocked}}
\index{openLocked@{openLocked}!mdtPortLock@{mdtPortLock}}
\subsubsection[{openLocked}]{\setlength{\rightskip}{0pt plus 5cm}int mdtPortLock::openLocked (
\begin{DoxyParamCaption}
\item[{const QString \&}]{portName, }
\item[{int}]{flags}
\end{DoxyParamCaption}
)}}
\label{classmdt_port_lock_a25e9a2cb8a10069fae75c76b6809c27f}


Open a port locked. 

At first, the lock file name will be buit for each lock directories found (searching in /tmp, /var/lock). Then, if no lock file is found, the port will be opened with open(). Just after open, the port will be locked with fcntl().


\begin{DoxyParams}{Parameters}
{\em portName} & Path to port to open (f.ex. /dev/ttyS0) \\
\hline
{\em flags} & Flags are simply passed to open() syscall (see open() man for details). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
File descriptor returned by open() , or -\/1 on error. 
\end{DoxyReturn}


Definition at line 44 of file mdtPortLock.cpp.

\hypertarget{classmdt_port_lock_a60b65f02d57568dc36c5e918aa5357a6}{
\index{mdtPortLock@{mdtPortLock}!unlock@{unlock}}
\index{unlock@{unlock}!mdtPortLock@{mdtPortLock}}
\subsubsection[{unlock}]{\setlength{\rightskip}{0pt plus 5cm}void mdtPortLock::unlock (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classmdt_port_lock_a60b65f02d57568dc36c5e918aa5357a6}


Unlock the port. 

Will remove lockfiles and unlock port with fcntl().

Note: use close() if file is not used later, this is not done by this method. 

Definition at line 113 of file mdtPortLock.cpp.



The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/mdtport/linux/mdtPortLock.h\item 
src/mdtport/linux/mdtPortLock.cpp\end{DoxyCompactItemize}
