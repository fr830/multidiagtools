<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Multi diag tools: src/mdtport/mdtUsbPort.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multi diag tools</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/mdtport/mdtUsbPort.h</div>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> **</span>
<a name="l00003"></a>00003 <span class="comment"> ** Copyright (C) 2011-2013 Philippe Steinmann.</span>
<a name="l00004"></a>00004 <span class="comment"> **</span>
<a name="l00005"></a>00005 <span class="comment"> ** This file is part of multiDiagTools library.</span>
<a name="l00006"></a>00006 <span class="comment"> **</span>
<a name="l00007"></a>00007 <span class="comment"> ** multiDiagTools is free software: you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment"> ** it under the terms of the GNU Lesser General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment"> ** the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment"> ** (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"> **</span>
<a name="l00012"></a>00012 <span class="comment"> ** multiDiagTools is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment"> ** but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment"> ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment"> ** GNU Lesser General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"> **</span>
<a name="l00017"></a>00017 <span class="comment"> ** You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00018"></a>00018 <span class="comment"> ** along with multiDiagTools.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00019"></a>00019 <span class="comment"> **</span>
<a name="l00020"></a>00020 <span class="comment"> ****************************************************************************/</span>
<a name="l00021"></a>00021 <span class="preprocessor">#ifndef MDT_USB_PORT_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#define MDT_USB_PORT_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;mdtAbstractPort.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;libusb-1.0/libusb.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;mdtFrameUsbControl.h&quot;</span>
<a name="l00027"></a>00027 
<a name="l00064"></a><a class="code" href="classmdt_usb_port.html">00064</a> <span class="keyword">class </span><a class="code" href="classmdt_usb_port.html" title="USB port I/O port class.">mdtUsbPort</a> : <span class="keyword">public</span> <a class="code" href="classmdt_abstract_port.html" title="Base class for port I/O.">mdtAbstractPort</a>
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066  <span class="keyword">public</span>:
<a name="l00067"></a>00067 
<a name="l00068"></a>00068   <a class="code" href="classmdt_usb_port.html" title="USB port I/O port class.">mdtUsbPort</a>(QObject *parent = 0);
<a name="l00069"></a>00069 
<a name="l00072"></a>00072   <a class="code" href="classmdt_usb_port.html#afa9f1942ca4ae384887441e01b362c16" title="Destructor.">~mdtUsbPort</a>();
<a name="l00073"></a>00073 
<a name="l00085"></a>00085   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#af2399348faf1abc20130eab20cfc36ee" title="Reconnect device.">reconnect</a>(<span class="keywordtype">int</span> timeout);
<a name="l00086"></a>00086 
<a name="l00091"></a>00091   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a44ed5024a81a573b5196b8f64c42cd6a" title="Set the read data timeout.">setReadTimeout</a>(<span class="keywordtype">int</span> timeout);
<a name="l00092"></a>00092 
<a name="l00097"></a>00097   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a592af88bd7e7f45dd80df0ecab375ace" title="Set the write data timeout.">setWriteTimeout</a>(<span class="keywordtype">int</span> timeout);
<a name="l00098"></a>00098 
<a name="l00105"></a>00105   QQueue&lt;mdtFrameUsbControl*&gt; &amp;<a class="code" href="classmdt_usb_port.html#af146b08006ddbe18fb537ae1a75b622e" title="Get the control pool queue.">controlFramesPool</a>();
<a name="l00106"></a>00106 
<a name="l00113"></a>00113   QQueue&lt;mdtFrameUsbControl*&gt; &amp;<a class="code" href="classmdt_usb_port.html#afbb20c403e7a5885d5e4221bab9f304e" title="Get the control query queue.">controlQueryFrames</a>();
<a name="l00114"></a>00114 
<a name="l00127"></a>00127   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a4fbcd0fcc179335c55c6d7ccc40a7c31" title="Add a control request.">addControlRequest</a>(<a class="code" href="classmdt_frame_usb_control.html" title="USB Control frame.">mdtFrameUsbControl</a> *frame, <span class="keywordtype">bool</span> setwIndexAsbInterfaceNumber = <span class="keyword">false</span>);
<a name="l00128"></a>00128 
<a name="l00141"></a>00141   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a274b6fd10bd84027bb66773ed805de2a" title="Submit a control query.">submitControlQuery</a>();
<a name="l00142"></a>00142 
<a name="l00161"></a>00161   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a84ddd2d0bf77b4db60358846c7da4853" title="Transfer callback for control endpoint.">controlTransferCallback</a>(<span class="keyword">struct</span> libusb_transfer *transfer);
<a name="l00162"></a>00162 
<a name="l00167"></a>00167   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a6566e654df8a1c3503941702593db3c5" title="Cancel current control transfer.">cancelControlTransfer</a>();
<a name="l00168"></a>00168 
<a name="l00175"></a>00175   QQueue&lt;mdtFrameUsbControl*&gt; &amp;<a class="code" href="classmdt_usb_port.html#a304825c7d9173a3dcb5e26a412f1038b" title="Get the control responses queue.">controlResponseFrames</a>();
<a name="l00176"></a>00176 
<a name="l00182"></a>00182   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a719fc7b43461a3e2d9a4926d3e3961c2" title="Request to read until a short packet is received.">requestReadUntilShortPacketReceived</a>();
<a name="l00183"></a>00183 
<a name="l00193"></a>00193   <span class="keywordtype">bool</span> <a class="code" href="classmdt_usb_port.html#a3c0685d67fe608abe24c140c2858779c" title="Check if a request to read until a short packet is received is pending.">readUntilShortPacketReceivedRequestPending</a>();
<a name="l00194"></a>00194 
<a name="l00204"></a>00204   <span class="keywordtype">int</span> <a class="code" href="classmdt_usb_port.html#af546a031ed8621fee1d5e9498cbcd174" title="Get read buffer size.">readBufferSize</a>() <span class="keyword">const</span>;
<a name="l00205"></a>00205 
<a name="l00217"></a>00217   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a5e380852b8726f71e8558c86cba5bd1f" title="Submit a read transfer.">initReadTransfer</a>(qint64 maxSize);
<a name="l00218"></a>00218 
<a name="l00233"></a>00233   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#ab4f1f0456c84f954604b192f6085c3f2" title="Transfer callback for read endpoint.">readTransferCallback</a>(<span class="keyword">struct</span> libusb_transfer *transfer);
<a name="l00234"></a>00234 
<a name="l00239"></a>00239   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a3570b708f9f51408e4bbf2f61cc8c881" title="Cancel current bulk/interrupt input transfer.">cancelReadTransfer</a>();
<a name="l00240"></a>00240 
<a name="l00247"></a>00247   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#af940b6fe25e874ff0746686bc30c4f2c" title="Clear halt on read endpoint.">clearReadEndpointHalt</a>();
<a name="l00248"></a>00248 
<a name="l00253"></a>00253   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#ab8ddd4ebee603ac381e8da0383a61e36" title="Wait until data is available on port.">waitForReadyRead</a>();
<a name="l00254"></a>00254 
<a name="l00265"></a>00265   qint64 <a class="code" href="classmdt_usb_port.html#abce257345c8af47494215cd7ee75f82d" title="Read data from port.">read</a>(<span class="keywordtype">char</span> *data, qint64 maxSize);
<a name="l00266"></a>00266 
<a name="l00281"></a>00281   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a897234cc2c7561da323cb124f57bcc28" title="Request a new interrupt input transfer for additional message input.">initMessageInTransfer</a>();
<a name="l00282"></a>00282 
<a name="l00297"></a>00297   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#ae8932368e2777356695ab69f6ed08f41" title="Transfer callback for message in (additional interrupt) endpoint.">messageInTransferCallback</a>(<span class="keyword">struct</span> libusb_transfer *transfer);
<a name="l00298"></a>00298 
<a name="l00303"></a>00303   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#afddcb02a1e2bd87609fd2b6305534560" title="Cancel current interrupt message input transfer.">cancelMessageInTransfer</a>();
<a name="l00304"></a>00304 
<a name="l00311"></a>00311   QQueue&lt;mdtFrame*&gt; &amp;<a class="code" href="classmdt_usb_port.html#a3ad4385983122fcaf6d2560b6bd43acf" title="Get the message IN frames pool.">messageInFramesPool</a>();
<a name="l00312"></a>00312 
<a name="l00319"></a>00319   QQueue&lt;mdtFrame*&gt; &amp;<a class="code" href="classmdt_usb_port.html#a3365431076a3197540cbc99278658bda" title="Get the message IN frames.">messageInFrames</a>();
<a name="l00320"></a>00320 
<a name="l00332"></a>00332   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#a38200f806037e06988e73af246e8a494" title="Add a frame to write.">addFrameToWrite</a>(<a class="code" href="classmdt_frame.html" title="Provide an array of bytes.">mdtFrame</a> *frame);
<a name="l00333"></a>00333 
<a name="l00348"></a>00348   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a3340dc3f53e857e39053988e4925fc97" title="Request a new bulk/interrupt out transfer.">initWriteTransfer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *data, qint64 maxSize);
<a name="l00349"></a>00349 
<a name="l00364"></a>00364   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#af910071a5a5c401cd20cee3519120cc2" title="Transfer callback for write endpoint.">writeTransferCallback</a>(<span class="keyword">struct</span> libusb_transfer *transfer);
<a name="l00365"></a>00365 
<a name="l00370"></a>00370   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a7cbe1cd3649861aac5e6a14830f06cf9" title="Cancel current bulk/interrupt input transfer.">cancelWriteTransfer</a>();
<a name="l00371"></a>00371 
<a name="l00378"></a>00378   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a2dd0f7c680fda1ca1247217fa4e3f2e8" title="Clear halt on write endpoint.">clearWriteEndpointHalt</a>();
<a name="l00379"></a>00379 
<a name="l00384"></a>00384   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#a3be875f6f10ae94fd3a94f925bb935e7" title="Wait until data can be written to port.">waitEventWriteReady</a>();
<a name="l00385"></a>00385 
<a name="l00392"></a>00392   qint64 <a class="code" href="classmdt_usb_port.html#ae777e33325ff2adef326dd7f81b00838" title="Write data to port.">write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="comment">/*data*/</span>, qint64 <span class="comment">/*maxSize*/</span>);
<a name="l00393"></a>00393 
<a name="l00400"></a>00400   <span class="keywordtype">void</span> <a class="code" href="classmdt_usb_port.html#aa857e94b4167c53b26573042ee3af280" title="Set error.">addError</a>(<a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">mdtAbstractPort::error_t</a> error);
<a name="l00401"></a>00401 
<a name="l00408"></a>00408   QList&lt;error_t&gt; <a class="code" href="classmdt_usb_port.html#a81855cebd9b672a74d836955236c19bf" title="Get the lis of current errors.">lastErrors</a>();
<a name="l00409"></a>00409 
<a name="l00416"></a>00416   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#afe5b473e1df8b828c17f83a45a3902fb" title="Cancel pending transfers.">cancelTransfers</a>();
<a name="l00417"></a>00417 
<a name="l00425"></a>00425   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> <a class="code" href="classmdt_usb_port.html#abb66e85fc1366112eeb0a6e86f6e7e32" title="Call libusb handle_event() function.">handleUsbEvents</a>();
<a name="l00426"></a>00426 
<a name="l00431"></a>00431   quint8 <a class="code" href="classmdt_usb_port.html#a860e89069ba433e6174c032a28d0eae2" title="Get current read endpoint address.">currentReadEndpointAddress</a>() <span class="keyword">const</span>;
<a name="l00432"></a>00432 
<a name="l00437"></a>00437   quint8 <a class="code" href="classmdt_usb_port.html#ae2319ee6ff5a2f4399410175fbac6a44" title="Get current write endpoint address.">currentWriteEndpointAddress</a>() <span class="keyword">const</span>;
<a name="l00438"></a>00438 
<a name="l00444"></a>00444   QQueue&lt;quint8&gt; &amp;<a class="code" href="classmdt_usb_port.html#a0ad07939f4709240b0c79c501edc9498" title="Get list of expeced incomming bTags.">expectedBulkInbTags</a>();
<a name="l00445"></a>00445 
<a name="l00446"></a>00446  <span class="keyword">private</span>:
<a name="l00447"></a>00447 
<a name="l00456"></a>00456   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> pvOpen();
<a name="l00457"></a>00457 
<a name="l00464"></a>00464   <span class="keywordtype">void</span> pvClose();
<a name="l00465"></a>00465 
<a name="l00473"></a>00473   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> pvSetup();
<a name="l00474"></a>00474 
<a name="l00480"></a>00480   <span class="keywordtype">void</span> pvFlushIn();
<a name="l00481"></a>00481 
<a name="l00487"></a>00487   <span class="keywordtype">void</span> pvFlushOut();
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="comment">// Map a libusb error to mdtAbstractPort::error_t</span>
<a name="l00490"></a>00490   <span class="comment">//  The endpoint helps to know if a error is associated</span>
<a name="l00491"></a>00491   <span class="comment">//  to a read, write or control process.</span>
<a name="l00492"></a>00492   <span class="comment">//  F.ex. timeout error will be mapped to ReadTimeout if read endpoint is concerned.</span>
<a name="l00493"></a>00493   <a class="code" href="classmdt_abstract_port.html#ad4121bb930c95887e77f8bafa065a85e" title="Error.">error_t</a> mapUsbError(<span class="keywordtype">int</span> error, quint8 endpoint);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <span class="comment">// Get a text for given libusb error code</span>
<a name="l00496"></a>00496   QString errorText(<span class="keywordtype">int</span> errorCode) <span class="keyword">const</span>;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   <span class="comment">// Diseable copy</span>
<a name="l00499"></a>00499   Q_DISABLE_COPY(<a class="code" href="classmdt_usb_port.html" title="USB port I/O port class.">mdtUsbPort</a>);
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pvReadTimeout;
<a name="l00502"></a>00502   <span class="keyword">struct </span>timeval pvReadTimeoutTv;
<a name="l00503"></a>00503   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pvWriteTimeout;
<a name="l00504"></a>00504   <span class="keyword">struct </span>timeval pvWriteTimeoutTv;
<a name="l00505"></a>00505   libusb_context *pvLibusbContext;
<a name="l00506"></a>00506   libusb_device_handle *pvHandle;
<a name="l00507"></a>00507   <span class="keywordtype">int</span> pvbInterfaceNumber;
<a name="l00508"></a>00508   <span class="comment">/*</span>
<a name="l00509"></a>00509 <span class="comment">   * Control endpoint members</span>
<a name="l00510"></a>00510 <span class="comment">   */</span>
<a name="l00511"></a>00511   <span class="keywordtype">char</span> *pvControlBuffer;
<a name="l00512"></a>00512   <span class="keywordtype">int</span> pvControlBufferSize;
<a name="l00513"></a>00513   libusb_transfer *pvControlTransfer;
<a name="l00514"></a>00514   <span class="keywordtype">bool</span> pvControlTransferPending;       <span class="comment">// Flag to see if a transfer is pending</span>
<a name="l00515"></a>00515   <a class="code" href="classmdt_frame_usb_control.html" title="USB Control frame.">mdtFrameUsbControl</a> *pvCurrentControlFrame;
<a name="l00516"></a>00516   <span class="comment">// Frames queues</span>
<a name="l00517"></a>00517   QQueue&lt;mdtFrameUsbControl*&gt; pvControlFramesPool;
<a name="l00518"></a>00518   QQueue&lt;mdtFrameUsbControl*&gt; pvControlQueryFrames;
<a name="l00519"></a>00519   QQueue&lt;mdtFrameUsbControl*&gt; pvControlResponseFrames;
<a name="l00520"></a>00520   <span class="comment">/*</span>
<a name="l00521"></a>00521 <span class="comment">   * Data bulk/interrupt IN endpoint members</span>
<a name="l00522"></a>00522 <span class="comment">   */</span>
<a name="l00523"></a>00523   <span class="keywordtype">char</span> *pvReadBuffer;
<a name="l00524"></a>00524   <span class="keywordtype">int</span> pvReadBufferSize;
<a name="l00525"></a>00525   quint8 pvReadEndpointAddress;
<a name="l00526"></a>00526   libusb_transfer_type pvReadTransfertType;
<a name="l00527"></a>00527   libusb_transfer *pvReadTransfer;
<a name="l00528"></a>00528   <span class="keywordtype">bool</span> pvReadTransferPending;       <span class="comment">// Flag to see if a transfer is pending</span>
<a name="l00529"></a>00529   <span class="keywordtype">bool</span> pvReadUntilShortPacketReceivedRequestPending;
<a name="l00530"></a>00530   <span class="comment">/*</span>
<a name="l00531"></a>00531 <span class="comment">   * Data bulk/interrupt OUT endpoint members</span>
<a name="l00532"></a>00532 <span class="comment">   */</span>
<a name="l00533"></a>00533   <span class="keywordtype">char</span> *pvWriteBuffer;
<a name="l00534"></a>00534   <span class="keywordtype">int</span> pvWriteBufferSize;
<a name="l00535"></a>00535   quint8 pvWriteEndpointAddress;
<a name="l00536"></a>00536   libusb_transfer_type pvWriteTransfertType;
<a name="l00537"></a>00537   libusb_transfer *pvWriteTransfer;
<a name="l00538"></a>00538   <span class="keywordtype">bool</span> pvWriteTransferPending;      <span class="comment">// Flag to see if a transfer is pending</span>
<a name="l00539"></a>00539   <span class="comment">/*</span>
<a name="l00540"></a>00540 <span class="comment">   * Some devices have a additional interrupt IN endpoint</span>
<a name="l00541"></a>00541 <span class="comment">   *  for urgent messages. Other use interrupt IN endpoint</span>
<a name="l00542"></a>00542 <span class="comment">   *  for standard I/O. This is the reason to use another</span>
<a name="l00543"></a>00543 <span class="comment">   *  name than ...interruptIn... for these members</span>
<a name="l00544"></a>00544 <span class="comment">   */</span>
<a name="l00545"></a>00545   <span class="keywordtype">char</span> *pvMessageInBuffer;
<a name="l00546"></a>00546   <span class="keywordtype">int</span> pvMessageInBufferSize;
<a name="l00547"></a>00547   quint8 pvMessageInEndpointAddress;
<a name="l00548"></a>00548   libusb_transfer *pvMessageInTransfer;
<a name="l00549"></a>00549   <span class="keywordtype">bool</span> pvMessageInTransferPending;  <span class="comment">// Flag to see if a transfer is pending</span>
<a name="l00550"></a>00550   <span class="comment">// Frames queues</span>
<a name="l00551"></a>00551   QQueue&lt;mdtFrame*&gt; pvMessageInFramesPool;  <span class="comment">// Frames pool</span>
<a name="l00552"></a>00552   QQueue&lt;mdtFrame*&gt; pvMessageInFrames;      <span class="comment">// Incomming message frames</span>
<a name="l00553"></a>00553 
<a name="l00554"></a>00554   QQueue&lt;error_t&gt; pvErrors;  <span class="comment">// Set by transfer callbacks and used by thread for notifications</span>
<a name="l00555"></a>00555   QQueue&lt;quint8&gt; pvExpectedBulkInbTags; <span class="comment">// This is used by USBTMC thread and port manager. See expectedBulkInbTags()</span>
<a name="l00556"></a>00556 };
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 <span class="preprocessor">#endif // #ifndef MDT_USB_PORT_H</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Sep 11 2013 20:08:43 for Multi diag tools by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
