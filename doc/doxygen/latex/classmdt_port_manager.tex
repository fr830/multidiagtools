\hypertarget{classmdt_port_manager}{\section{mdt\-Port\-Manager Class Reference}
\label{classmdt_port_manager}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}}
}


Port manager base class.  




{\ttfamily \#include $<$mdt\-Port\-Manager.\-h$>$}



Inheritance diagram for mdt\-Port\-Manager\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classmdt_port_manager__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for mdt\-Port\-Manager\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classmdt_port_manager__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382da}{state\-\_\-t} \{ \\*
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daabac9679c411402c9db01399ecb72b84d}{Port\-Closed} = 0, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daadbd7b0395c62e9ae38525c5dc5ba44a6}{Stopped}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaca288962f5cb3d352f44f4e4c15f14d2}{Starting}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa1c68525fc2c4d94e39a73d1a4bea0476}{Stopping}, 
\\*
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaa7af1c561e17e65982c027de942d4a75}{Running}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa2440f5bfc7ae5c78db1598ef6d3d394c}{Port\-Error}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3a3b42b9d783381f3c7447086503fde6}{Port\-Ready}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa4004253e25d51b1e628bb5006dbbd153}{Disconnected}, 
\\*
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa89e805c9c75c39ecc8371d5f38131227}{Connecting}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3c3620c8eb4ddb126568053e3d49195f}{Connected}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaf2ba40e19587c3a98235ee96a4acf20e}{Ready}, 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa5da3fa5dd98a264ecb4a37a1983ea0ff}{Busy}
 \}
\begin{DoxyCompactList}\small\item\em State of device. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classmdt_port_manager_a1d185e9bb610aee16ccd9499ae7bff0d}{abort} ()
\begin{DoxyCompactList}\small\item\em Cancel read and write operations. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Signals}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}{new\-Transaction\-Done} (\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$transaction)
\begin{DoxyCompactList}\small\item\em Emitted each time a transaction is done. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a6f6c6f8a8430d8631a08c765565db9ab}{status\-Message\-Changed} (const Q\-String \&message, const Q\-String \&details, int timeout)
\begin{DoxyCompactList}\small\item\em Emitted when a new status message is to display. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a01da0634bc52a71c0df0d83fc166eeda}{state\-Changed} (int state\-Id)
\begin{DoxyCompactList}\small\item\em Emitted each time the state changed. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ae00d513ed335fbd203852dcb7180005c}{state\-Changed\-For\-Ui} (int state\-Id, const Q\-String \&state\-Text, int led\-Color\-Id, bool led\-Is\-On)
\begin{DoxyCompactList}\small\item\em Emitted only if a state that must be notified is entered. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ae77c1b24291797704488beda0009c57a}{pm\-Port\-Closed\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when port was closed. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aa12ccb053b3ce050a2482a957b28222e}{pm\-Start\-Threads\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when threads must be started. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a7b81ee6491167fa17574d840720d9b33}{pm\-Stop\-Threads\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when threads must be stopped. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a6dd5529e6de23897fe5082ee4a33fa3d}{pm\-All\-Threads\-Ready\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when all threads are ready. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a1bfd4d20867ecae2cad1b95b52860b12}{pm\-All\-Threads\-Stopped\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when all threads are stopped. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a94d3fa4a26f8686449313a54003f0b4d}{pm\-Unhandled\-Error\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when a unhandled error occured. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a04fb1d09af226677cacd6f0e485d9810}{pm\-Connecting\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when connection with device beginns. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a871ec7f9676a12c84196404285cf2161}{pm\-Connected\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when connection with device is established. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ab4667ac04a31166eeb7b5f92893b16db}{pm\-Disconnected\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when connection with device was lost/closed. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a57fc083d7db52279ec6b990b75705552}{pm\-Connection\-Failed\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when connection failed on startup or after max try. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a5959d4025f4903eef0ea65c350f6f9b3}{pm\-Busy\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when device is busy (or other slow down reason..) \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aa23c17048773e345778e7d6393f630db}{pm\-Ready\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when device and communication becomes ready again. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}{pm\-Transaction\-Timeout\-Event} ()
\begin{DoxyCompactList}\small\item\em Sent when a transaction timeout occured. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmdt_port_manager_a5ec36523089b7528d973e29cdbc64d01}{mdt\-Port\-Manager} (\hyperlink{class_q_object}{Q\-Object} $\ast$parent=0)
\begin{DoxyCompactList}\small\item\em Contruct a port manager. \end{DoxyCompactList}\item 
virtual \hyperlink{classmdt_port_manager_adf797f8fd7a3ffdc000890a224e4c1b6}{$\sim$mdt\-Port\-Manager} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
virtual Q\-List$<$ \hyperlink{classmdt_port_info}{mdt\-Port\-Info} $\ast$ $>$ \hyperlink{classmdt_port_manager_ad56afb411ab5468005fca04767557ece}{scan} ()
\begin{DoxyCompactList}\small\item\em Scan for available ports. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port} (\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} $\ast$port)
\begin{DoxyCompactList}\small\item\em Set port object. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a3107b7121dfe5b9686d9b3b3a48a0af0}{lock\-Port\-Mutex} ()
\begin{DoxyCompactList}\small\item\em Lock the port's mutex. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a882e6bf95dac9cd4ab8cc93ecc524874}{unlock\-Port\-Mutex} ()
\begin{DoxyCompactList}\small\item\em Unlock port's mutex. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a39cb4af4aedc0b6b7c4d4f53002c3fd1}{detach\-Port} (bool delete\-Port, bool delete\-Threads)
\begin{DoxyCompactList}\small\item\em Detach port. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}{add\-Thread} (\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Add a thread and assign it to port. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$ \hyperlink{classmdt_port_manager_ad9233b5156a45f2684783317d75fdf9b}{read\-Thread} ()
\begin{DoxyCompactList}\small\item\em Returns instance of reader thread. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$ \hyperlink{classmdt_port_manager_af44b6e9876e6687b1d4fe7e05ffd5a91}{write\-Thread} ()
\begin{DoxyCompactList}\small\item\em Returns instance of writer thread. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aaa0a474183bcae0fff4fb9ef43023c25}{remove\-Threads} (bool release\-Memory)
\begin{DoxyCompactList}\small\item\em Detach threads from port and remove threads. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classmdt_port_manager_af1fb103ffafc227337a59c7e82f44fbc}{start} ()
\begin{DoxyCompactList}\small\item\em Start port manager. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aacbf87cc3d9c37c87e21696f8a6514bd}{stop} ()
\begin{DoxyCompactList}\small\item\em Stop port manager. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a2b2ed690cbba9f544c6ac1b46684e59a}{set\-Port\-Name} (const Q\-String \&\hyperlink{classmdt_port_manager_af4fcab6aaad98d74aeabfc972da1d406}{port\-Name})
\begin{DoxyCompactList}\small\item\em Set port name. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a7e2ef93ec2731e66aa2b2d5f7ce9bc1c}{set\-Port\-Info} (\hyperlink{classmdt_port_info}{mdt\-Port\-Info} info)
\begin{DoxyCompactList}\small\item\em Set port info. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_info}{mdt\-Port\-Info} \hyperlink{classmdt_port_manager_a88109b455fc5a5f5adf0636f7450143e}{port\-Info} ()
\begin{DoxyCompactList}\small\item\em Get current port info. \end{DoxyCompactList}\item 
Q\-String \hyperlink{classmdt_port_manager_af4fcab6aaad98d74aeabfc972da1d406}{port\-Name} () const 
\begin{DoxyCompactList}\small\item\em Get current port name. \end{DoxyCompactList}\item 
virtual \hyperlink{classmdt_port_config}{mdt\-Port\-Config} \& \hyperlink{classmdt_port_manager_a9cf3ea2da38f81682695b37448712ffd}{config} ()
\begin{DoxyCompactList}\small\item\em Get the port's config object. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_config}{mdt\-Port\-Config} \& \hyperlink{classmdt_port_manager_a735b7dc766fc2f45fb2cf9772c4201b0}{config} () const 
\begin{DoxyCompactList}\small\item\em Get the port's config object. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a9adb5098766c9df588bc9978b00c5eb2}{set\-Keep\-Transactions\-Done} (bool keep)
\begin{DoxyCompactList}\small\item\em Force transactions done to be keeped. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_a798ce0939234870ae3b9995108e54380}{keep\-Transactions\-Done} () const 
\begin{DoxyCompactList}\small\item\em Get the keep\-Transactions\-Done flag. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$ \hyperlink{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}{get\-New\-Transaction} ()
\begin{DoxyCompactList}\small\item\em Get a new transaction. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}{restore\-Transaction} (\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$transaction)
\begin{DoxyCompactList}\small\item\em Restore a transaction into pool. \end{DoxyCompactList}\item 
virtual int \hyperlink{classmdt_port_manager_ad98399edba146af5cf32a9002094385c}{send\-Data} (\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$transaction)
\begin{DoxyCompactList}\small\item\em Send data on port. \end{DoxyCompactList}\item 
virtual int \hyperlink{classmdt_port_manager_a445b27f0819158f67f1bd548cdd2fedf}{send\-Data} (const Q\-Byte\-Array \&data, bool query\-Reply\-Mode=false)
\begin{DoxyCompactList}\small\item\em Send data to port. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_a5551802de2c08632078f2cc0e2607913}{wait\-Transaction\-Done} (int id)
\begin{DoxyCompactList}\small\item\em Wait until a transaction is done. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_af60f089baded850018cbb90645c8e547}{wait\-One\-Transaction\-Done} ()
\begin{DoxyCompactList}\small\item\em Wait until current transaction is done. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aaa85e0200aba0e0f4392dfe01abae2cf}{wait} (int ms)
\begin{DoxyCompactList}\small\item\em Wait for some time. \end{DoxyCompactList}\item 
Q\-Byte\-Array \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame} (int id)
\begin{DoxyCompactList}\small\item\em Get data by frame I\-D. \end{DoxyCompactList}\item 
Q\-List$<$ Q\-Byte\-Array $>$ \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames} ()
\begin{DoxyCompactList}\small\item\em Get all readen data. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_manager_ac0844a5cd4043a95a479d458ac7ce590}{flush\-In} (bool flush\-Port\-Manager\-Buffers, bool flush\-Port\-Buffers)
\begin{DoxyCompactList}\small\item\em Flush input buffers. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a4c44ce6ec40c4afc6be441c10d7ee827}{flush\-In} ()
\begin{DoxyCompactList}\small\item\em Flush input buffers. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_manager_a3f0c2722a41c49de2bea9013bccd049c}{flush\-Out} (bool flush\-Port\-Manager\-Buffers, bool flush\-Port\-Buffers)
\begin{DoxyCompactList}\small\item\em Flush output buffers. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ab34018a9653a5af784fa7da06a9e50d3}{flush\-Out} ()
\begin{DoxyCompactList}\small\item\em Flush output buffers. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a97b91e7c1641836eb6afb47fd244a18e}{flush} (bool flush\-Port\-Manager\-Buffers, bool flush\-Port\-Buffers)
\begin{DoxyCompactList}\small\item\em Flush I/\-O buffers. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a3eab774008d7530ae341ce9c38265d65}{flush} ()
\begin{DoxyCompactList}\small\item\em Flush I/\-O buffers. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382da}{state\-\_\-t} \hyperlink{classmdt_port_manager_a59241d9e6b6ee71e6c1aeb3e6c0ca81a}{current\-State} () const 
\begin{DoxyCompactList}\small\item\em Get current state. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a0c460b47b12e38e708321be79f6343d8}{notify\-Current\-State} ()
\begin{DoxyCompactList}\small\item\em Notify the current state. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classmdt_port_manager_a6dc2798324521d177fb8f79d4f6c5f0f}{is\-Ready} () const 
\begin{DoxyCompactList}\small\item\em Check if port manager is ready. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed} () const 
\begin{DoxyCompactList}\small\item\em Check if port is closed. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Slots}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classmdt_port_manager_a4fcc8f0699b655156e661bb3de6056cc}{from\-Thread\-New\-Frame\-Readen} ()
\begin{DoxyCompactList}\small\item\em Called by the read thread whenn a complete frame was readen. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_manager_a7e45b8e3475e5182ed12218616664d07}{on\-Threads\-Error\-Occured} (int error)
\begin{DoxyCompactList}\small\item\em Manage errors comming from port threads. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual bool \hyperlink{classmdt_port_manager_aab594613e8985590c835194efbc27b5e}{open\-Port} ()
\begin{DoxyCompactList}\small\item\em Open the port. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ace8065f1f5083041ee7f65c2892bc77d}{close\-Port} ()
\begin{DoxyCompactList}\small\item\em Close the port. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a3f1d25b2441c467c0de9908c73422a93}{set\-Current\-Transaction\-Id} (int id)
\begin{DoxyCompactList}\small\item\em Set the current transaction I\-D. \end{DoxyCompactList}\item 
int \hyperlink{classmdt_port_manager_a19abf29c8948cde0337d67c9722c25aa}{current\-Transaction\-Id} () const 
\begin{DoxyCompactList}\small\item\em Get the current transaction I\-D. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a4d009936a0a5130f3bfecb69fee4ce42}{increment\-Current\-Transaction\-Id} (int min=0, int max=I\-N\-T\-\_\-\-M\-A\-X)
\begin{DoxyCompactList}\small\item\em Increment current transaction I\-D. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_ac04a12f8aa20ba04695083afce45a6cc}{wait\-Transaction\-Possible} ()
\begin{DoxyCompactList}\small\item\em Wait until transaction pending queue has less than maximum possible items. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_ac58ed84e0e9230d1931557bc4bbe8a50}{add\-Transaction\-Pending} (\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$transaction)
\begin{DoxyCompactList}\small\item\em Add a transaction to pending queue. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$ \hyperlink{classmdt_port_manager_a18478707a9be7638b06cde48ced48297}{transaction\-Pending} (int id)
\begin{DoxyCompactList}\small\item\em Take pending transaction matching id. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending} ()
\begin{DoxyCompactList}\small\item\em Restore all transactions pending to pool. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a4b584d9005316be9991e6026e4c5e5a4}{add\-Transaction\-Done} (\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$transaction)
\begin{DoxyCompactList}\small\item\em Add a transaction to the D\-O\-N\-E queue. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_a3293066f4c3ed2e4b116f28dca8c5d64}{transactions\-Done\-Contains} (int id) const 
\begin{DoxyCompactList}\small\item\em Check if a transaction with given I\-D exists in done queue. \end{DoxyCompactList}\item 
\hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} $\ast$ \hyperlink{classmdt_port_manager_a5869bcf6774a86fb9d3b00a0d4211bb5}{transaction\-Done} (int id)
\begin{DoxyCompactList}\small\item\em Take transaction from D\-O\-N\-E queue matching id. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done} ()
\begin{DoxyCompactList}\small\item\em Restore all transactions done to pool. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}{start\-Transaction\-Timer} (int timeout)
\begin{DoxyCompactList}\small\item\em Start transaction timer. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}{stop\-Transaction\-Timer} ()
\begin{DoxyCompactList}\small\item\em Stop transaction timer. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}{transaction\-Timeout\-Occured} () const 
\begin{DoxyCompactList}\small\item\em Check if a transaction timeout occured. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}{commit\-Frames} ()
\begin{DoxyCompactList}\small\item\em Emit signals for each done transactions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} $\ast$ \hyperlink{classmdt_port_manager_af856162aab4f1c5202c1dfb330fae538}{pv\-Port}
\item 
Q\-List$<$ \hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$ $>$ \hyperlink{classmdt_port_manager_a8e0d49b789f8b01d469e84b487799573}{pv\-Threads}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Port manager base class. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000029}{Todo}]Port manager has no raison to inherit \hyperlink{class_q_thread}{Q\-Thread} -\/$>$ make it inherit \hyperlink{class_q_object}{Q\-Object} \end{DoxyRefDesc}


Manages a port based on \hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} an several threads based on \hyperlink{classmdt_port_thread}{mdt\-Port\-Thread}. The goal is to hide the complexity of the port A\-P\-I.

Example\-: 
\begin{DoxyCode}
\hyperlink{classmdt_port_manager}{mdtPortManager} m;
\hyperlink{classmdt_port}{mdtPort} *port;
\hyperlink{classmdt_port_config}{mdtPortConfig} *\hyperlink{classmdt_port_manager_a9cf3ea2da38f81682695b37448712ffd}{config};
QList<QByteArray> responses;

\textcolor{comment}{// Setup}
config = \textcolor{keyword}{new} \hyperlink{classmdt_port_config}{mdtPortConfig};
config->\hyperlink{classmdt_port_config_a627adcb87d26757238f844db19fc248d}{setFrameType}(\hyperlink{classmdt_frame_af936e37d5fe4c066c0fb0161fafd4a17ac649559564652abbe656b97d4a84b722}{mdtFrame::FT\_ASCII});
config->\hyperlink{classmdt_port_config_a3c5e1c444a18da7d68430bd1c14030f4}{setEndOfFrameSeq}(\textcolor{stringliteral}{"$"});

\textcolor{comment}{// Init port}
port = \textcolor{keyword}{new} \hyperlink{classmdt_port}{mdtPort};
port->\hyperlink{classmdt_abstract_port_a48bdc0a8057c3b119763643098cf798f}{setConfig}(config);

\textcolor{comment}{// Init port manager - We wand blocking mode}
m.setTransactionsDisabled(\textcolor{keyword}{true});
m.\hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{setPort}(port);
m.\hyperlink{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}{addThread}(mew mdtPortWriteThread);
m.\hyperlink{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}{addThread}(mew mdtPortReadThread);
m.\hyperlink{classmdt_port_manager_a2b2ed690cbba9f544c6ac1b46684e59a}{setPortName}(\textcolor{stringliteral}{"/dev/xyz"}));

\textcolor{comment}{// Start port manager - Will open port, start threads and return once port manager is ready}
\textcolor{keywordflow}{if}(!m.\hyperlink{classmdt_port_manager_af1fb103ffafc227337a59c7e82f44fbc}{start}())\{
 \textcolor{comment}{// Handle error}
\}

\textcolor{comment}{// Send some data}
\textcolor{keywordflow}{if}(!m.writeData(\textcolor{stringliteral}{"Test$"}))\{
 \textcolor{comment}{// Handle error}
\}

\textcolor{comment}{// Wait on answer - Timout: 1500 [ms]}
\textcolor{keywordflow}{if}(!m.waitReadenFrame(1500))\{
 \textcolor{comment}{// Timout , handle error}
\}

\textcolor{comment}{// Do something with received data}
responses = m.\hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readenFrames}();
\textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<responses.size(); i++)\{
 qDebug() << responses.at(i);
\}

\textcolor{comment}{// Stop port manager}
m.\hyperlink{classmdt_port_manager_aacbf87cc3d9c37c87e21696f8a6514bd}{stop}();

\textcolor{comment}{// Cleanup - detachPort() will delete port and threads objects}
m.\hyperlink{classmdt_port_manager_a39cb4af4aedc0b6b7c4d4f53002c3fd1}{detachPort}(\textcolor{keyword}{true}, \textcolor{keyword}{true});
\textcolor{keyword}{delete} \hyperlink{classmdt_port_manager_a9cf3ea2da38f81682695b37448712ffd}{config};
\end{DoxyCode}


A (recommended) alternative is to disable frames enqueuing and use the new\-Readen\-Frame(\-Q\-Byte\-Array) signal.
\begin{DoxyItemize}
\item Disable enqueuing with set\-Transactions\-Disabled(false)
\item Connect new\-Readen\-Frame(\-Q\-Byte\-Array) to a slot 


\end{DoxyItemize}

Manage a port based on \hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} and related threads. Goal is to hide complexity of \hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} A\-P\-I.

Depending on application, it's possible to use a event approach, or also a blocking approach with wait methods.

Some protocols support frame identifier (like M\-O\-D\-B\-U\-S/\-T\-C\-P, U\-S\-B\-T\-M\-C, or others), and other don't (for example raw bytes transfert on a serial port). For this reason, the concept of transactions is aodpted here. A transaction is based on \hyperlink{classmdt_port_transaction}{mdt\-Port\-Transaction} class. It was introduced for protocols that support identification, and can store some other meta data, usefull to decode a reply.

This base class can be used directly for ports that supports raw transfers. For specific protocol, it can be subclassed.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000030}{Todo}]Document init, open, close, ...\end{DoxyRefDesc}


Now, we can see the data transfer workflow\-:
\begin{DoxyItemize}
\item 1) Wait until it's possible to send some data with wait\-On\-Write\-Ready()
\item 2) Get a new transaction with \hyperlink{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}{get\-New\-Transaction()} , and setup it as needed (see remarks below).
\item 3) Send data using write\-Data(mdt\-Port\-Transaction$\ast$). This will set the current\-Transaction\-Id to the I\-D given in transaction.
\item 4a) If you choosed a blocking approach, use \hyperlink{classmdt_port_manager_a5551802de2c08632078f2cc0e2607913}{wait\-Transaction\-Done()}.
\item 4b) If you choosed a event approach, connect the \hyperlink{classmdt_port_manager_a5869bcf6774a86fb9d3b00a0d4211bb5}{transaction\-Done()} signal to a slot. Each time a transaction is done, you will receive a transaction.
\item 5) Get the transaction with \hyperlink{classmdt_port_manager_a5869bcf6774a86fb9d3b00a0d4211bb5}{transaction\-Done()}.
\item 6) Restore transaction with \hyperlink{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}{restore\-Transaction()}.
\end{DoxyItemize}

Steps 2) and 3) can be done once by using write\-Data(const Q\-Byte\-Array\&, bool). Steps 5) and 6) can be done once by using get\-Readen\-Data(int).

Here is a little example of the simple approach\-: 
\begin{DoxyCode}
\hyperlink{classmdt_port_manager}{mdtPortManager} m;
\textcolor{keywordtype}{int} transactionId;
\textcolor{comment}{// Setup...}

\textcolor{comment}{// Wait until we can write}
\textcolor{keywordflow}{if}(!waitOnWriteReady())\{
  \textcolor{comment}{// Handle error}
\}

\textcolor{comment}{// Send data to port}
transactionId = writeData(\textcolor{stringliteral}{"SomeData"}, \textcolor{keyword}{true});
\textcolor{keywordflow}{if}(transactionId < 0)\{
  \textcolor{comment}{// Handle error}
\}

\textcolor{comment}{// Wait until data come in}
\textcolor{keywordflow}{if}(\hyperlink{classmdt_port_manager_a5551802de2c08632078f2cc0e2607913}{waitTransactionDone}(transactionId))\{
  \textcolor{comment}{// Handle error}
\}

\textcolor{comment}{// Get only data for a specific transaction (should be used only for protocols that support transaction)}
qDebug() << \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readenFrame}(transactionId);
\textcolor{comment}{// Get all received data}
qDebug() << \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readenFrames}();
\end{DoxyCode}


Internally, once data was send to port's write queue, the transaction is stored in the pending transactions queue.

Dealing with incomming data\-: In above example, 2 methods are shown to get incomming data\-:
\begin{DoxyItemize}
\item \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame(int)} \-: will work with protocols that support frame I\-D. See specific port manager subclass for details.
\item \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} \-: see below.
\end{DoxyItemize}

If we are using a protocol that not support frame I\-D, it's possible that we receive data each time, also without sending any request. This must be handled in \hyperlink{classmdt_port_manager_a4fcc8f0699b655156e661bb3de6056cc}{from\-Thread\-New\-Frame\-Readen()} slot. In this \hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} class, the following will happen\-:
\begin{DoxyItemize}
\item When sending data with write\-Data(const Q\-Byte\-Array\&, bool), current transaction I\-D will be incremented with \hyperlink{classmdt_port_manager_a4d009936a0a5130f3bfecb69fee4ce42}{increment\-Current\-Transaction\-Id()}.
\item In \hyperlink{classmdt_port_manager_a4fcc8f0699b655156e661bb3de6056cc}{from\-Thread\-New\-Frame\-Readen()} slot, \hyperlink{classmdt_port_manager_a19abf29c8948cde0337d67c9722c25aa}{current\-Transaction\-Id()} is used to get pending transaction with \hyperlink{classmdt_port_manager_a18478707a9be7638b06cde48ced48297}{transaction\-Pending()}. If it was found, frame's data is copied, and transaction is moved to done queue. If not found, a new transaction is taken with \hyperlink{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}{get\-New\-Transaction()}, frame's data is copied, and transaction is enqueued to done queue with \hyperlink{classmdt_port_manager_a4b584d9005316be9991e6026e4c5e5a4}{add\-Transaction\-Done()}.
\item \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} will return a list of data that comes from transactions Done list. Current transaction I\-D will be restet to 0.
\end{DoxyItemize}

The Query/\-Reply mode\-: port manager is able to handle event or blocking mode in same time. This cause a problem for done transactions handling. For example, when we choosed the event based aproach for a transaction, port manager will emit the \hyperlink{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}{new\-Transaction\-Done(mdt\-Port\-Transaction$\ast$)} signal, then restore transaction back to pool. When we choosed blocking approach, port manager will also emit \hyperlink{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}{new\-Transaction\-Done(mdt\-Port\-Transaction$\ast$)} signal, wich can be usefull to keep, for example, a G\-U\-I coherent in each mode. But here, the transaction must not be restored directly, but only once data was readen with \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} or \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()}. To handle this, \hyperlink{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}{commit\-Frames()} will use \hyperlink{classmdt_port_transaction_a9da1cc7a191cd21a2e532d277aa3c628}{mdt\-Port\-Transaction\-::is\-Query\-Reply\-Mode()}. 

Definition at line 197 of file mdt\-Port\-Manager.\-h.



\subsection{Member Enumeration Documentation}
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382da}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!state\-\_\-t@{state\-\_\-t}}
\index{state\-\_\-t@{state\-\_\-t}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{state\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf mdt\-Port\-Manager\-::state\-\_\-t}}}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382da}


State of device. 

States are handled by \hyperlink{classmdt_port_manager_state_machine}{mdt\-Port\-Manager\-State\-Machine} \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{Port\-Closed@{Port\-Closed}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Port\-Closed@{Port\-Closed}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daabac9679c411402c9db01399ecb72b84d}{Port\-Closed}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daabac9679c411402c9db01399ecb72b84d}
}]Port is closed \index{Stopped@{Stopped}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Stopped@{Stopped}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daadbd7b0395c62e9ae38525c5dc5ba44a6}{Stopped}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daadbd7b0395c62e9ae38525c5dc5ba44a6}
}]Threads are stopped and port is closing \index{Starting@{Starting}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Starting@{Starting}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaca288962f5cb3d352f44f4e4c15f14d2}{Starting}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaca288962f5cb3d352f44f4e4c15f14d2}
}]Threads are starting \index{Stopping@{Stopping}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Stopping@{Stopping}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa1c68525fc2c4d94e39a73d1a4bea0476}{Stopping}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa1c68525fc2c4d94e39a73d1a4bea0476}
}]Threads are stopping \index{Running@{Running}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Running@{Running}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaa7af1c561e17e65982c027de942d4a75}{Running}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaa7af1c561e17e65982c027de942d4a75}
}]Global state (sub machine) \index{Port\-Error@{Port\-Error}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Port\-Error@{Port\-Error}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa2440f5bfc7ae5c78db1598ef6d3d394c}{Port\-Error}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa2440f5bfc7ae5c78db1598ef6d3d394c}
}]A unhandled error occured -\/ Threads will be stopped and port closed \index{Port\-Ready@{Port\-Ready}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Port\-Ready@{Port\-Ready}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3a3b42b9d783381f3c7447086503fde6}{Port\-Ready}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3a3b42b9d783381f3c7447086503fde6}
}]Port is open and threads are running. At this point, communication is possible if not connection is required (f.\-ex. serial port terminal) \index{Disconnected@{Disconnected}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Disconnected@{Disconnected}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa4004253e25d51b1e628bb5006dbbd153}{Disconnected}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa4004253e25d51b1e628bb5006dbbd153}
}]Port is ready, but not connected to device \index{Connecting@{Connecting}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Connecting@{Connecting}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa89e805c9c75c39ecc8371d5f38131227}{Connecting}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa89e805c9c75c39ecc8371d5f38131227}
}]Trying to connect to device \index{Connected@{Connected}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Connected@{Connected}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3c3620c8eb4ddb126568053e3d49195f}{Connected}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa3c3620c8eb4ddb126568053e3d49195f}
}]Global state (sub machine) \index{Ready@{Ready}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Ready@{Ready}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaf2ba40e19587c3a98235ee96a4acf20e}{Ready}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daaf2ba40e19587c3a98235ee96a4acf20e}
}]Port is ready and connection to device was made. Communication is possible \index{Busy@{Busy}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!Busy@{Busy}}\item[{\em 
\hypertarget{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa5da3fa5dd98a264ecb4a37a1983ea0ff}{Busy}\label{classmdt_port_manager_a9448339d7f08ca5e18b904df25b382daa5da3fa5dd98a264ecb4a37a1983ea0ff}
}]Port is up and device is connected but cannot accept requests for the moment \end{description}
\end{Desc}


Definition at line 207 of file mdt\-Port\-Manager.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classmdt_port_manager_a5ec36523089b7528d973e29cdbc64d01}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!mdt\-Port\-Manager@{mdt\-Port\-Manager}}
\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{mdt\-Port\-Manager}]{\setlength{\rightskip}{0pt plus 5cm}mdt\-Port\-Manager\-::mdt\-Port\-Manager (
\begin{DoxyParamCaption}
\item[{{\bf Q\-Object} $\ast$}]{parent = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a5ec36523089b7528d973e29cdbc64d01}


Contruct a port manager. 

keep\-Transactions\-Done flag will be unset (set false). 

Definition at line 32 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Manager\-State\-Machine\-::build\-Main\-State\-Machine(), pm\-Transaction\-Timeout\-Event(), pv\-Port, and set\-Keep\-Transactions\-Done().

\hypertarget{classmdt_port_manager_adf797f8fd7a3ffdc000890a224e4c1b6}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!$\sim$mdt\-Port\-Manager@{$\sim$mdt\-Port\-Manager}}
\index{$\sim$mdt\-Port\-Manager@{$\sim$mdt\-Port\-Manager}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{$\sim$mdt\-Port\-Manager}]{\setlength{\rightskip}{0pt plus 5cm}mdt\-Port\-Manager\-::$\sim$mdt\-Port\-Manager (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_adf797f8fd7a3ffdc000890a224e4c1b6}


Destructor. 

If a port was set, the manager will stop (if running), and port will be closed (if open).

Note that port set by \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} and threads are not deleted. This is because port and threads are set by subclass, or from application. 

Definition at line 59 of file mdt\-Port\-Manager.\-cpp.



References pv\-Port, and stop().



\subsection{Member Function Documentation}
\hypertarget{classmdt_port_manager_a1d185e9bb610aee16ccd9499ae7bff0d}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!abort@{abort}}
\index{abort@{abort}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{abort}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::abort (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [slot]}}}\label{classmdt_port_manager_a1d185e9bb610aee16ccd9499ae7bff0d}


Cancel read and write operations. 

Default implementation calls \hyperlink{classmdt_abstract_port_abde440c49b95833f821e1333c40a7398}{mdt\-Abstract\-Port\-::flush()}. 

Definition at line 596 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::flush(), and pv\-Port.



Referenced by mdt\-Port\-Term\-::on\-\_\-pb\-Send\-Cmd\-Abort\-\_\-clicked().

\hypertarget{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!add\-Thread@{add\-Thread}}
\index{add\-Thread@{add\-Thread}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{add\-Thread}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::add\-Thread (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Thread} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}


Add a thread and assign it to port. 

\begin{DoxyPrecond}{Precondition}
Port must be set with set\-Port before using this method 

Manager must no running 

Port manager must be closed (see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). 
\end{DoxyPrecond}


Definition at line 122 of file mdt\-Port\-Manager.\-cpp.



References from\-Thread\-New\-Frame\-Readen(), mdt\-Port\-Thread\-::handles\-Timeout(), is\-Closed(), mdt\-Port\-Thread\-::is\-Reader(), mdt\-Port\-Thread\-::is\-Writer(), on\-Threads\-Error\-Occured(), pm\-Connected\-Event(), pv\-Port, pv\-Threads, and mdt\-Port\-Thread\-::set\-Port().



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::mdt\-Modbus\-Tcp\-Port\-Manager(), mdt\-Serial\-Port\-Manager\-::mdt\-Serial\-Port\-Manager(), mdt\-Usbtmc\-Port\-Manager\-::mdt\-Usbtmc\-Port\-Manager(), and mdt\-Usb\-Port\-Manager\-::start().

\hypertarget{classmdt_port_manager_a4b584d9005316be9991e6026e4c5e5a4}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!add\-Transaction\-Done@{add\-Transaction\-Done}}
\index{add\-Transaction\-Done@{add\-Transaction\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{add\-Transaction\-Done}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::add\-Transaction\-Done (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Transaction} $\ast$}]{transaction}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a4b584d9005316be9991e6026e4c5e5a4}


Add a transaction to the D\-O\-N\-E queue. 

\begin{DoxyPrecond}{Precondition}
transaction must be a valid pointer. 
\end{DoxyPrecond}


Definition at line 720 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::id(), and transactions\-Done\-Contains().



Referenced by mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), and from\-Thread\-New\-Frame\-Readen().

\hypertarget{classmdt_port_manager_ac58ed84e0e9230d1931557bc4bbe8a50}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!add\-Transaction\-Pending@{add\-Transaction\-Pending}}
\index{add\-Transaction\-Pending@{add\-Transaction\-Pending}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{add\-Transaction\-Pending}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::add\-Transaction\-Pending (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Transaction} $\ast$}]{transaction}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_ac58ed84e0e9230d1931557bc4bbe8a50}


Add a transaction to pending queue. 

Add a existing transaction to the pending queue. A transaction can be requested with \hyperlink{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}{get\-New\-Transaction()}.

\begin{DoxyPrecond}{Precondition}
transaction must be a valid pointer. 

transaction I\-D must not allready exist in queue. 
\end{DoxyPrecond}


Definition at line 675 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Error\-::commit(), mdt\-Error\-::\-Error, mdt\-Port\-Transaction\-::id(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, and pm\-Unhandled\-Error\-Event().



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request().

\hypertarget{classmdt_port_manager_ace8065f1f5083041ee7f65c2892bc77d}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!close\-Port@{close\-Port}}
\index{close\-Port@{close\-Port}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{close\-Port}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::close\-Port (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_ace8065f1f5083041ee7f65c2892bc77d}


Close the port. 

If port was never set (with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} ), this method does nothing. 

Definition at line 618 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::close(), flush\-Transactions\-Done(), flush\-Transactions\-Pending(), and pv\-Port.



Referenced by stop().

\hypertarget{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!commit\-Frames@{commit\-Frames}}
\index{commit\-Frames@{commit\-Frames}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{commit\-Frames}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::commit\-Frames (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}


Emit signals for each done transactions. 

Will emit \hyperlink{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}{new\-Transaction\-Done(mdt\-Port\-Transaction$\ast$)} for each transaction found in done queue.

If query\-Reply\-Mode and keep\-Transactions\-Done are not set, the transaction is restored back to pool, else it will be restored only after a call of \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} or \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()}. 

Definition at line 791 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::is\-Query\-Reply\-Mode(), keep\-Transactions\-Done(), new\-Transaction\-Done(), and restore\-Transaction().



Referenced by mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), and from\-Thread\-New\-Frame\-Readen().

\hypertarget{classmdt_port_manager_a9cf3ea2da38f81682695b37448712ffd}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!config@{config}}
\index{config@{config}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{config}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Config} \& mdt\-Port\-Manager\-::config (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_a9cf3ea2da38f81682695b37448712ffd}


Get the port's config object. 

Usefull to alter internal port configuration

\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_serial_port_manager_a4b8ab7b9d53966a1887d9ce8557b8416}{mdt\-Serial\-Port\-Manager}.



Definition at line 264 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::config(), and pv\-Port.



Referenced by mdt\-Device\-D\-S\-O1000\-A\-::mdt\-Device\-D\-S\-O1000\-A(), mdt\-Device\-Modbus\-::mdt\-Device\-Modbus(), mdt\-Device\-Scpi\-::mdt\-Device\-Scpi(), mdt\-Device\-U3606\-A\-::mdt\-Device\-U3606\-A(), mdt\-Modbus\-Tcp\-Port\-Manager\-::mdt\-Modbus\-Tcp\-Port\-Manager(), mdt\-Usb\-Port\-Manager\-::mdt\-Usb\-Port\-Manager(), open\-Port(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), wait\-One\-Transaction\-Done(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a735b7dc766fc2f45fb2cf9772c4201b0}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!config@{config}}
\index{config@{config}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{config}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Config} \& mdt\-Port\-Manager\-::config (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_manager_a735b7dc766fc2f45fb2cf9772c4201b0}


Get the port's config object. 

Usefull to read internal port configuration

\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 
\end{DoxyPrecond}


Definition at line 271 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::config(), and pv\-Port.

\hypertarget{classmdt_port_manager_a59241d9e6b6ee71e6c1aeb3e6c0ca81a}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!current\-State@{current\-State}}
\index{current\-State@{current\-State}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{current\-State}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Manager\-::state\-\_\-t} mdt\-Port\-Manager\-::current\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_manager_a59241d9e6b6ee71e6c1aeb3e6c0ca81a}


Get current state. 



Definition at line 568 of file mdt\-Port\-Manager.\-cpp.



References mdt\-State\-Machine\-::current\-State().



Referenced by mdt\-Device\-::current\-State(), is\-Closed(), mdt\-Usbtmc\-Port\-Manager\-::is\-Ready(), mdt\-Modbus\-Tcp\-Port\-Manager\-::is\-Ready(), is\-Ready(), on\-Threads\-Error\-Occured(), start(), wait\-One\-Transaction\-Done(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a19abf29c8948cde0337d67c9722c25aa}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!current\-Transaction\-Id@{current\-Transaction\-Id}}
\index{current\-Transaction\-Id@{current\-Transaction\-Id}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{current\-Transaction\-Id}]{\setlength{\rightskip}{0pt plus 5cm}int mdt\-Port\-Manager\-::current\-Transaction\-Id (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a19abf29c8948cde0337d67c9722c25aa}


Get the current transaction I\-D. 



Definition at line 636 of file mdt\-Port\-Manager.\-cpp.



Referenced by from\-Thread\-New\-Frame\-Readen(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Status\-Byte\-Request().

\hypertarget{classmdt_port_manager_a39cb4af4aedc0b6b7c4d4f53002c3fd1}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!detach\-Port@{detach\-Port}}
\index{detach\-Port@{detach\-Port}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{detach\-Port}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::detach\-Port (
\begin{DoxyParamCaption}
\item[{bool}]{delete\-Port, }
\item[{bool}]{delete\-Threads}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a39cb4af4aedc0b6b7c4d4f53002c3fd1}


Detach port. 

Will detach port from each thread and from port manager. If port was not set, this method does nothing. If manager is running, it will be stopped. If port is open, it will be closed.


\begin{DoxyParams}{Parameters}
{\em delete\-Port} & If true, the port object that was set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} will be deleted. \\
\hline
{\em delete\-Threads} & If true, each thread added with \hyperlink{classmdt_port_manager_ab62591409d019a4a2576b4310c411b8f}{add\-Thread()} will be deleted. \\
\hline
\end{DoxyParams}


Definition at line 102 of file mdt\-Port\-Manager.\-cpp.



References is\-Closed(), pv\-Port, remove\-Threads(), and stop().



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::$\sim$mdt\-Modbus\-Tcp\-Port\-Manager(), mdt\-Serial\-Port\-Manager\-::$\sim$mdt\-Serial\-Port\-Manager(), and mdt\-Usb\-Port\-Manager\-::$\sim$mdt\-Usb\-Port\-Manager().

\hypertarget{classmdt_port_manager_a97b91e7c1641836eb6afb47fd244a18e}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush@{flush}}
\index{flush@{flush}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush (
\begin{DoxyParamCaption}
\item[{bool}]{flush\-Port\-Manager\-Buffers, }
\item[{bool}]{flush\-Port\-Buffers}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a97b91e7c1641836eb6afb47fd244a18e}


Flush I/\-O buffers. 


\begin{DoxyParams}{Parameters}
{\em flush\-Port\-Manager\-Buffers} & If true, port manager buffers will be cleared. (Has no effect in this implementation, but some subclass can have output buffers). \\
\hline
{\em flush\-Port\-Buffers} & If true, port's buffers will be cleared. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before calling this method. 
\end{DoxyPrecond}


Definition at line 552 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::flush(), flush\-In(), flush\-Out(), and pv\-Port.

\hypertarget{classmdt_port_manager_a3eab774008d7530ae341ce9c38265d65}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush@{flush}}
\index{flush@{flush}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a3eab774008d7530ae341ce9c38265d65}


Flush I/\-O buffers. 

\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before calling this method. 
\end{DoxyPrecond}


Definition at line 563 of file mdt\-Port\-Manager.\-cpp.

\hypertarget{classmdt_port_manager_ac0844a5cd4043a95a479d458ac7ce590}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-In@{flush\-In}}
\index{flush\-In@{flush\-In}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-In}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-In (
\begin{DoxyParamCaption}
\item[{bool}]{flush\-Port\-Manager\-Buffers, }
\item[{bool}]{flush\-Port\-Buffers}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_ac0844a5cd4043a95a479d458ac7ce590}


Flush input buffers. 


\begin{DoxyParams}{Parameters}
{\em flush\-Port\-Manager\-Buffers} & If true, port manager buffers (transactions done and pending) will be cleared. \\
\hline
{\em flush\-Port\-Buffers} & If true, port's buffers will be cleared. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before calling this method. 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_usb_port_manager_a982256ed17db155e1c95d544683a6dba}{mdt\-Usb\-Port\-Manager}.



Definition at line 518 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::flush\-In(), flush\-Transactions\-Done(), flush\-Transactions\-Pending(), and pv\-Port.

\hypertarget{classmdt_port_manager_a4c44ce6ec40c4afc6be441c10d7ee827}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-In@{flush\-In}}
\index{flush\-In@{flush\-In}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-In}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-In (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a4c44ce6ec40c4afc6be441c10d7ee827}


Flush input buffers. 

Will flush portmanger and port's buffers.

Internally, \hyperlink{classmdt_port_manager_ac0844a5cd4043a95a479d458ac7ce590}{flush\-In(bool, bool)} is called. 

Definition at line 535 of file mdt\-Port\-Manager.\-cpp.



Referenced by flush(), and mdt\-Usb\-Port\-Manager\-::flush\-In().

\hypertarget{classmdt_port_manager_a3f0c2722a41c49de2bea9013bccd049c}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-Out@{flush\-Out}}
\index{flush\-Out@{flush\-Out}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-Out}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-Out (
\begin{DoxyParamCaption}
\item[{bool}]{flush\-Port\-Manager\-Buffers, }
\item[{bool}]{flush\-Port\-Buffers}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_a3f0c2722a41c49de2bea9013bccd049c}


Flush output buffers. 


\begin{DoxyParams}{Parameters}
{\em flush\-Port\-Manager\-Buffers} & If true, port manager buffers will be cleared. (Has no effect in this implementation, but some subclass can have output buffers). \\
\hline
{\em flush\-Port\-Buffers} & If true, port's buffers will be cleared. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before calling this method. 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_usb_port_manager_ab723086376175c40635df44adf358985}{mdt\-Usb\-Port\-Manager}.



Definition at line 540 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::flush\-Out(), and pv\-Port.

\hypertarget{classmdt_port_manager_ab34018a9653a5af784fa7da06a9e50d3}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-Out@{flush\-Out}}
\index{flush\-Out@{flush\-Out}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-Out}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-Out (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_ab34018a9653a5af784fa7da06a9e50d3}


Flush output buffers. 

Will flush portmanger and port's buffers.

Internally, \hyperlink{classmdt_port_manager_a3f0c2722a41c49de2bea9013bccd049c}{flush\-Out(bool, bool)} is called. 

Definition at line 547 of file mdt\-Port\-Manager.\-cpp.



Referenced by flush(), and mdt\-Usb\-Port\-Manager\-::flush\-Out().

\hypertarget{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-Transactions\-Done@{flush\-Transactions\-Done}}
\index{flush\-Transactions\-Done@{flush\-Transactions\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-Transactions\-Done}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-Transactions\-Done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}


Restore all transactions done to pool. 



Definition at line 759 of file mdt\-Port\-Manager.\-cpp.



References restore\-Transaction().



Referenced by close\-Port(), flush\-In(), and on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!flush\-Transactions\-Pending@{flush\-Transactions\-Pending}}
\index{flush\-Transactions\-Pending@{flush\-Transactions\-Pending}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{flush\-Transactions\-Pending}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::flush\-Transactions\-Pending (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}


Restore all transactions pending to pool. 



Definition at line 706 of file mdt\-Port\-Manager.\-cpp.



References restore\-Transaction().



Referenced by close\-Port(), flush\-In(), and on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_a4fcc8f0699b655156e661bb3de6056cc}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!from\-Thread\-New\-Frame\-Readen@{from\-Thread\-New\-Frame\-Readen}}
\index{from\-Thread\-New\-Frame\-Readen@{from\-Thread\-New\-Frame\-Readen}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{from\-Thread\-New\-Frame\-Readen}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [slot]}}}\label{classmdt_port_manager_a4fcc8f0699b655156e661bb3de6056cc}


Called by the read thread whenn a complete frame was readen. 

This variant will add data to transactions done queue. If pending transactions queue contains \hyperlink{classmdt_port_manager_a19abf29c8948cde0337d67c9722c25aa}{current\-Transaction\-Id()}, it will be removed.

For subclass that handle frames with I\-Ds, this method must be reimplemented. The normal way is to get the frame in pending queue with \hyperlink{classmdt_port_manager_a18478707a9be7638b06cde48ced48297}{transaction\-Pending()}. For frames with I\-D that not exists in pending queue, it must be choosen to discard them, or adopt another behaviour.

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread}
\end{DoxySeeAlso}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000028}{Todo}]A méditer\-:
\begin{DoxyItemize}
\item Lock le mutex
\item Prendre les frames disponibles (-\/$>$ sdans une liste ...)
\item Libéréer le mutex
\item Effectier les traitements
\item Lock le mutex
\item Restituer les frames
\item Libéréer le mutex 
\end{DoxyItemize}\end{DoxyRefDesc}


Definition at line 816 of file mdt\-Port\-Manager.\-cpp.



References add\-Transaction\-Done(), mdt\-Error\-::commit(), commit\-Frames(), current\-Transaction\-Id(), mdt\-Error\-::\-Error, get\-New\-Transaction(), mdt\-Port\-Transaction\-::id(), increment\-Current\-Transaction\-Id(), mdt\-Frame\-::is\-Complete(), lock\-Port\-Mutex(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, pv\-Port, mdt\-Abstract\-Port\-::readen\-Frames(), mdt\-Abstract\-Port\-::read\-Frames\-Pool(), mdt\-Port\-Transaction\-::set\-Data(), mdt\-Port\-Transaction\-::set\-Id(), transaction\-Pending(), and unlock\-Port\-Mutex().



Referenced by add\-Thread(), and remove\-Threads().

\hypertarget{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!get\-New\-Transaction@{get\-New\-Transaction}}
\index{get\-New\-Transaction@{get\-New\-Transaction}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{get\-New\-Transaction}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Transaction} $\ast$ mdt\-Port\-Manager\-::get\-New\-Transaction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a75ebd3d1859e3ed38b9558981e53aac4}


Get a new transaction. 

If transactions pool is empty, a new transaction is created. Note that each transaction should be put back in pool with \hyperlink{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}{restore\-Transaction()}. In most cases, if a method that uses transactions fails, the transaction must be restored with \hyperlink{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}{restore\-Transaction()}. See write\-Data(mdt\-Port\-Transaction$\ast$), write\-Data(const Q\-Byte\-Array\&), \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()}, \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done()}, \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} and \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} for details about restoration of transaction.

\begin{DoxyReturn}{Returns}
A empty transaction (\hyperlink{classmdt_port_transaction_a5f7b04df58291d52e61c5bd1b7f7bb7f}{mdt\-Port\-Transaction\-::clear()} is called internally).
\end{DoxyReturn}
\begin{DoxyPostcond}{Postcondition}
Returned transaction is valid (never Null). 
\end{DoxyPostcond}


Definition at line 288 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::clear(), mdt\-Error\-::commit(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, and mdt\-Error\-::\-Warning.



Referenced by from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Hardware\-Node\-Address(), mdt\-Device\-::get\-New\-Transaction(), mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Register\-Values(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), mdt\-Usbtmc\-Port\-Manager\-::send\-Query(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), and mdt\-Modbus\-Tcp\-Port\-Manager\-::set\-Register\-Values().

\hypertarget{classmdt_port_manager_a4d009936a0a5130f3bfecb69fee4ce42}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!increment\-Current\-Transaction\-Id@{increment\-Current\-Transaction\-Id}}
\index{increment\-Current\-Transaction\-Id@{increment\-Current\-Transaction\-Id}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{increment\-Current\-Transaction\-Id}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::increment\-Current\-Transaction\-Id (
\begin{DoxyParamCaption}
\item[{int}]{min = {\ttfamily 0}, }
\item[{int}]{max = {\ttfamily INT\-\_\-MAX}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a4d009936a0a5130f3bfecb69fee4ce42}


Increment current transaction I\-D. 



Definition at line 641 of file mdt\-Port\-Manager.\-cpp.



Referenced by from\-Thread\-New\-Frame\-Readen(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Status\-Byte\-Request().

\hypertarget{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!is\-Closed@{is\-Closed}}
\index{is\-Closed@{is\-Closed}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{is\-Closed}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::is\-Closed (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_manager_aeecbec49376838ab3547729636166d97}


Check if port is closed. 

Returns true if threads are all stopped and port is closed 

Definition at line 591 of file mdt\-Port\-Manager.\-cpp.



References current\-State(), and Port\-Closed.



Referenced by add\-Thread(), mdt\-Device\-Modbus\-Wago\-::connect\-To\-Device(), mdt\-Device\-Scpi\-::connect\-To\-Device(), mdt\-Device\-Modbus\-::connect\-To\-Device(), detach\-Port(), mdt\-Usb\-Port\-Manager\-::read\-Until\-Short\-Packet\-Received(), remove\-Threads(), mdt\-Usb\-Port\-Manager\-::scan(), mdt\-Usbtmc\-Port\-Manager\-::scan(), mdt\-Serial\-Port\-Manager\-::scan(), mdt\-Modbus\-Tcp\-Port\-Manager\-::scan(), mdt\-Usb\-Port\-Manager\-::send\-Control\-Request(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), set\-Port(), set\-Port\-Info(), set\-Port\-Name(), start(), stop(), mdt\-Modbus\-Tcp\-Port\-Manager\-::try\-To\-Connect(), mdt\-Usb\-Port\-Manager\-::wait\-Readen\-Control\-Response(), and wait\-Transaction\-Possible().

\hypertarget{classmdt_port_manager_a6dc2798324521d177fb8f79d4f6c5f0f}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!is\-Ready@{is\-Ready}}
\index{is\-Ready@{is\-Ready}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{is\-Ready}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::is\-Ready (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_a6dc2798324521d177fb8f79d4f6c5f0f}


Check if port manager is ready. 

Internally, the current\-State is used to check if port manager is ready. This implementation returns true if current\-State is Port\-Ready or Ready.

For some port type, it can be mandatory to be connected to device before any data can be transferred. In such case, reimplement this method. 

Reimplemented in \hyperlink{classmdt_modbus_tcp_port_manager_a5477eb7e8d57c5a42004046b426e39b6}{mdt\-Modbus\-Tcp\-Port\-Manager}, and \hyperlink{classmdt_usbtmc_port_manager_a0b90ceb0bbf424222ec878a355d206d7}{mdt\-Usbtmc\-Port\-Manager}.



Definition at line 582 of file mdt\-Port\-Manager.\-cpp.



References current\-State(), Port\-Ready, and Ready.



Referenced by mdt\-Device\-::is\-Ready(), mdt\-Usb\-Port\-Manager\-::send\-Control\-Request(), send\-Data(), start(), wait\-One\-Transaction\-Done(), wait\-Transaction\-Done(), and wait\-Transaction\-Possible().

\hypertarget{classmdt_port_manager_a798ce0939234870ae3b9995108e54380}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!keep\-Transactions\-Done@{keep\-Transactions\-Done}}
\index{keep\-Transactions\-Done@{keep\-Transactions\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{keep\-Transactions\-Done}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::keep\-Transactions\-Done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_manager_a798ce0939234870ae3b9995108e54380}


Get the keep\-Transactions\-Done flag. 



Definition at line 283 of file mdt\-Port\-Manager.\-cpp.



Referenced by commit\-Frames().

\hypertarget{classmdt_port_manager_a3107b7121dfe5b9686d9b3b3a48a0af0}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!lock\-Port\-Mutex@{lock\-Port\-Mutex}}
\index{lock\-Port\-Mutex@{lock\-Port\-Mutex}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{lock\-Port\-Mutex}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::lock\-Port\-Mutex (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a3107b7121dfe5b9686d9b3b3a48a0af0}


Lock the port's mutex. 

This method will check a internal flag before locking port's mutex. If the flag syas that mutex is allready locked, a warning is logged with \hyperlink{classmdt_error}{mdt\-Error} system. Then, this method reurns without locking the port mutex again.

\begin{DoxyPrecond}{Precondition}
Port must be set with set\-Port before using this method 
\end{DoxyPrecond}


Definition at line 80 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Error\-::commit(), mdt\-Abstract\-Port\-::lock\-Mutex(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, pv\-Port, and mdt\-Error\-::\-Warning.



Referenced by mdt\-Usb\-Port\-Manager\-::from\-Thread\-Control\-Response\-Readen(), mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), from\-Thread\-New\-Frame\-Readen(), mdt\-Usb\-Port\-Manager\-::read\-Until\-Short\-Packet\-Received(), mdt\-Usb\-Port\-Manager\-::send\-Control\-Request(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request().

\hypertarget{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!new\-Transaction\-Done@{new\-Transaction\-Done}}
\index{new\-Transaction\-Done@{new\-Transaction\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{new\-Transaction\-Done}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::new\-Transaction\-Done (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Transaction} $\ast$}]{transaction}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a416a24db1048e9f66aef27ea810954d2}


Emitted each time a transaction is done. 

Note\-: the transaction pointer is only valid for one call, do not store it for later usage. Connect this signal to a slot that runs in G\-U\-I thread only.

This signal is emited by \hyperlink{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}{commit\-Frames()}. 

Referenced by commit\-Frames().

\hypertarget{classmdt_port_manager_a0c460b47b12e38e708321be79f6343d8}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!notify\-Current\-State@{notify\-Current\-State}}
\index{notify\-Current\-State@{notify\-Current\-State}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{notify\-Current\-State}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::notify\-Current\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a0c460b47b12e38e708321be79f6343d8}


Notify the current state. 

Will force to emit \hyperlink{classmdt_port_manager_a01da0634bc52a71c0df0d83fc166eeda}{state\-Changed()} and \hyperlink{classmdt_port_manager_ae00d513ed335fbd203852dcb7180005c}{state\-Changed\-For\-Ui()} .

Can be usefull during application setup, because some initial states (like Port\-Closed) are directly notified, probably before signals are connected to application slots. 

Definition at line 575 of file mdt\-Port\-Manager.\-cpp.



References mdt\-State\-Machine\-::notify\-Current\-State().



Referenced by mdt\-Device\-Modbus\-::mdt\-Device\-Modbus(), mdt\-Modbus\-Io\-Tool\-::mdt\-Modbus\-Io\-Tool(), and mdt\-Abstract\-Port\-Setup\-Dialog\-::set\-Port\-Manager().

\hypertarget{classmdt_port_manager_a7e45b8e3475e5182ed12218616664d07}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!on\-Threads\-Error\-Occured@{on\-Threads\-Error\-Occured}}
\index{on\-Threads\-Error\-Occured@{on\-Threads\-Error\-Occured}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{on\-Threads\-Error\-Occured}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::on\-Threads\-Error\-Occured (
\begin{DoxyParamCaption}
\item[{int}]{error}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [slot]}}}\label{classmdt_port_manager_a7e45b8e3475e5182ed12218616664d07}


Manage errors comming from port threads. 

This implementation will handle some common errors, change the current state emiting transistion signal. If state has changed, \hyperlink{classmdt_port_manager_a01da0634bc52a71c0df0d83fc166eeda}{state\-Changed()} signal is emited.

Handled errors are\-:
\begin{DoxyItemize}
\item No\-Error\-: go to ready state.
\item Write\-Canceled\-: flush pending transaction with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()} and go to warning state.
\item Write\-Timeout\-: flush pending transaction with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()} and go to busy state.
\item Write\-Pool\-Empty\-: go to busy state.
\item Read\-Canceled\-: flush pending transaction with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()}, done transactions with \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done()} and go to warning state.
\item Read\-Timeout\-: flush pending transaction with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()}, done transactions with \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done()} and go to busy state.
\item Read\-Pool\-Empty\-: go to busy state.
\item Disconnected\-: flush pending transaction with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()}, done transactions with \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done()} and go to disconnected state.
\item Connecting\-: go to connecting state.
\end{DoxyItemize}

For other errors, including Unhandled\-Error, pending transactions are flushed with \hyperlink{classmdt_port_manager_a85b87522eb9ec9b80ff24e3ad2ef4a00}{flush\-Transactions\-Pending()}, done transactions are flushed with \hyperlink{classmdt_port_manager_aad801de5f93a3619d98b7ea3cae6b999}{flush\-Transactions\-Done()} and state will become error state.

For other cases, the subclass can reimplement this method. Dont forget to emit transistion signals. 

Definition at line 861 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::\-Connecting, mdt\-Abstract\-Port\-::\-Connection\-Failed, current\-State(), mdt\-Abstract\-Port\-::\-Disconnected, flush\-Transactions\-Done(), flush\-Transactions\-Pending(), mdt\-Abstract\-Port\-::\-No\-Error, pm\-Busy\-Event(), pm\-Connecting\-Event(), pm\-Connection\-Failed\-Event(), pm\-Disconnected\-Event(), pm\-Ready\-Event(), pm\-Transaction\-Timeout\-Event(), pm\-Unhandled\-Error\-Event(), mdt\-Abstract\-Port\-::\-Read\-Canceled, mdt\-Abstract\-Port\-::\-Read\-Pool\-Empty, mdt\-Abstract\-Port\-::\-Read\-Timeout, mdt\-Abstract\-Port\-::\-Read\-Write\-Busy, mdt\-Abstract\-Port\-::\-Write\-Canceled, mdt\-Abstract\-Port\-::\-Write\-Pool\-Empty, and mdt\-Abstract\-Port\-::\-Write\-Timeout.



Referenced by add\-Thread(), mdt\-Usb\-Port\-Manager\-::on\-Threads\-Error\-Occured(), and remove\-Threads().

\hypertarget{classmdt_port_manager_aab594613e8985590c835194efbc27b5e}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!open\-Port@{open\-Port}}
\index{open\-Port@{open\-Port}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{open\-Port}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::open\-Port (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}}\label{classmdt_port_manager_aab594613e8985590c835194efbc27b5e}


Open the port. 

Will try to open port defined with \hyperlink{classmdt_port_manager_a2b2ed690cbba9f544c6ac1b46684e59a}{set\-Port\-Name()} or \hyperlink{classmdt_port_manager_a7e2ef93ec2731e66aa2b2d5f7ce9bc1c}{set\-Port\-Info()}

\begin{DoxyReturn}{Returns}
True on success, false else. 
\end{DoxyReturn}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 
\end{DoxyPrecond}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000031}{Todo}]Should return \hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85e}{mdt\-Abstract\-Port\-::error\-\_\-t} \end{DoxyRefDesc}


Definition at line 603 of file mdt\-Port\-Manager.\-cpp.



References config(), mdt\-Abstract\-Port\-::\-No\-Error, pv\-Port, set\-Current\-Transaction\-Id(), mdt\-Abstract\-Port\-::setup(), and mdt\-Port\-Config\-::write\-Queue\-Size().



Referenced by start().

\hypertarget{classmdt_port_manager_a6dd5529e6de23897fe5082ee4a33fa3d}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-All\-Threads\-Ready\-Event@{pm\-All\-Threads\-Ready\-Event}}
\index{pm\-All\-Threads\-Ready\-Event@{pm\-All\-Threads\-Ready\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-All\-Threads\-Ready\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-All\-Threads\-Ready\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a6dd5529e6de23897fe5082ee4a33fa3d}


Sent when all threads are ready. 

Used by state machine \hypertarget{classmdt_port_manager_a1bfd4d20867ecae2cad1b95b52860b12}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-All\-Threads\-Stopped\-Event@{pm\-All\-Threads\-Stopped\-Event}}
\index{pm\-All\-Threads\-Stopped\-Event@{pm\-All\-Threads\-Stopped\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-All\-Threads\-Stopped\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-All\-Threads\-Stopped\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a1bfd4d20867ecae2cad1b95b52860b12}


Sent when all threads are stopped. 

Used by state machine \hypertarget{classmdt_port_manager_a5959d4025f4903eef0ea65c350f6f9b3}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Busy\-Event@{pm\-Busy\-Event}}
\index{pm\-Busy\-Event@{pm\-Busy\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Busy\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Busy\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a5959d4025f4903eef0ea65c350f6f9b3}


Sent when device is busy (or other slow down reason..) 

Used by state machine 

Referenced by on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_a871ec7f9676a12c84196404285cf2161}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Connected\-Event@{pm\-Connected\-Event}}
\index{pm\-Connected\-Event@{pm\-Connected\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Connected\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Connected\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a871ec7f9676a12c84196404285cf2161}


Sent when connection with device is established. 

Used by state machine 

Referenced by add\-Thread(), and remove\-Threads().

\hypertarget{classmdt_port_manager_a04fb1d09af226677cacd6f0e485d9810}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Connecting\-Event@{pm\-Connecting\-Event}}
\index{pm\-Connecting\-Event@{pm\-Connecting\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Connecting\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Connecting\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a04fb1d09af226677cacd6f0e485d9810}


Sent when connection with device beginns. 

Used by state machine 

Referenced by on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_a57fc083d7db52279ec6b990b75705552}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Connection\-Failed\-Event@{pm\-Connection\-Failed\-Event}}
\index{pm\-Connection\-Failed\-Event@{pm\-Connection\-Failed\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Connection\-Failed\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Connection\-Failed\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a57fc083d7db52279ec6b990b75705552}


Sent when connection failed on startup or after max try. 

Used by state machine 

Referenced by on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_ab4667ac04a31166eeb7b5f92893b16db}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Disconnected\-Event@{pm\-Disconnected\-Event}}
\index{pm\-Disconnected\-Event@{pm\-Disconnected\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Disconnected\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Disconnected\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_ab4667ac04a31166eeb7b5f92893b16db}


Sent when connection with device was lost/closed. 

Used by state machine 

Referenced by on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_ae77c1b24291797704488beda0009c57a}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Port\-Closed\-Event@{pm\-Port\-Closed\-Event}}
\index{pm\-Port\-Closed\-Event@{pm\-Port\-Closed\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Port\-Closed\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Port\-Closed\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_ae77c1b24291797704488beda0009c57a}


Sent when port was closed. 

Used by state machine 

Referenced by stop().

\hypertarget{classmdt_port_manager_aa23c17048773e345778e7d6393f630db}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Ready\-Event@{pm\-Ready\-Event}}
\index{pm\-Ready\-Event@{pm\-Ready\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Ready\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Ready\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_aa23c17048773e345778e7d6393f630db}


Sent when device and communication becomes ready again. 

Used by state machine 

Referenced by on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_aa12ccb053b3ce050a2482a957b28222e}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Start\-Threads\-Event@{pm\-Start\-Threads\-Event}}
\index{pm\-Start\-Threads\-Event@{pm\-Start\-Threads\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Start\-Threads\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Start\-Threads\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_aa12ccb053b3ce050a2482a957b28222e}


Sent when threads must be started. 

Used by state machine 

Referenced by start().

\hypertarget{classmdt_port_manager_a7b81ee6491167fa17574d840720d9b33}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Stop\-Threads\-Event@{pm\-Stop\-Threads\-Event}}
\index{pm\-Stop\-Threads\-Event@{pm\-Stop\-Threads\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Stop\-Threads\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Stop\-Threads\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a7b81ee6491167fa17574d840720d9b33}


Sent when threads must be stopped. 

Used by state machine 

Referenced by stop().

\hypertarget{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Transaction\-Timeout\-Event@{pm\-Transaction\-Timeout\-Event}}
\index{pm\-Transaction\-Timeout\-Event@{pm\-Transaction\-Timeout\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Transaction\-Timeout\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Transaction\-Timeout\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}


Sent when a transaction timeout occured. 

A transaction timeout can be notified by a port thread, or/and internall transaction timer.

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}{transaction\-Timeout\-Occured()} 

on\-Transaction\-Timeout\-Occured() 

\hyperlink{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}{start\-Transaction\-Timer()} 

\hyperlink{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}{stop\-Transaction\-Timer()} 
\end{DoxySeeAlso}


Referenced by mdt\-Port\-Manager(), and on\-Threads\-Error\-Occured().

\hypertarget{classmdt_port_manager_a94d3fa4a26f8686449313a54003f0b4d}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pm\-Unhandled\-Error\-Event@{pm\-Unhandled\-Error\-Event}}
\index{pm\-Unhandled\-Error\-Event@{pm\-Unhandled\-Error\-Event}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pm\-Unhandled\-Error\-Event}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::pm\-Unhandled\-Error\-Event (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a94d3fa4a26f8686449313a54003f0b4d}


Sent when a unhandled error occured. 

Used by state machine 

Referenced by add\-Transaction\-Pending(), mdt\-Usb\-Port\-Manager\-::on\-Threads\-Error\-Occured(), on\-Threads\-Error\-Occured(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a88109b455fc5a5f5adf0636f7450143e}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!port\-Info@{port\-Info}}
\index{port\-Info@{port\-Info}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{port\-Info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Info} mdt\-Port\-Manager\-::port\-Info (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a88109b455fc5a5f5adf0636f7450143e}


Get current port info. 



Definition at line 254 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Serial\-Port\-Manager\-::scan(), mdt\-Usb\-Port\-Manager\-::scan(), and mdt\-Modbus\-Tcp\-Port\-Manager\-::scan().

\hypertarget{classmdt_port_manager_af4fcab6aaad98d74aeabfc972da1d406}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!port\-Name@{port\-Name}}
\index{port\-Name@{port\-Name}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{port\-Name}]{\setlength{\rightskip}{0pt plus 5cm}Q\-String mdt\-Port\-Manager\-::port\-Name (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_manager_af4fcab6aaad98d74aeabfc972da1d406}


Get current port name. 



Definition at line 259 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Info\-::port\-Name().



Referenced by mdt\-Usb\-Port\-Manager\-::scan().

\hypertarget{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!readen\-Frame@{readen\-Frame}}
\index{readen\-Frame@{readen\-Frame}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{readen\-Frame}]{\setlength{\rightskip}{0pt plus 5cm}Q\-Byte\-Array mdt\-Port\-Manager\-::readen\-Frame (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}


Get data by frame I\-D. 

The frame I\-D is a protocol specific identification. F.\-ex. in M\-O\-D\-B\-U\-S/\-T\-C\-P, the transaction I\-D is used, or b\-Tag for U\-S\-B\-T\-M\-C.

If found, the frame is removed from done queue. (A second call with same I\-D will return a empty Q\-Byte\-Array).

If I\-D was not found, a empty Q\-Byte\-Array is returned. 

Definition at line 488 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::data(), restore\-Transaction(), and transaction\-Done().



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Hardware\-Node\-Address(), mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Register\-Values(), mdt\-Usbtmc\-Port\-Manager\-::send\-Query(), mdt\-Modbus\-Tcp\-Port\-Manager\-::set\-Register\-Values(), and mdt\-Device\-::wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!readen\-Frames@{readen\-Frames}}
\index{readen\-Frames@{readen\-Frames}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{readen\-Frames}]{\setlength{\rightskip}{0pt plus 5cm}Q\-List$<$ Q\-Byte\-Array $>$ mdt\-Port\-Manager\-::readen\-Frames (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}


Get all readen data. 

Note that calling this methode will clear the internal queue. (A second call will return a empty list). 

Definition at line 501 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::data(), and restore\-Transaction().

\hypertarget{classmdt_port_manager_ad9233b5156a45f2684783317d75fdf9b}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!read\-Thread@{read\-Thread}}
\index{read\-Thread@{read\-Thread}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{read\-Thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Thread} $\ast$ mdt\-Port\-Manager\-::read\-Thread (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_ad9233b5156a45f2684783317d75fdf9b}


Returns instance of reader thread. 

Note that a Null pointer can be returned 

Definition at line 146 of file mdt\-Port\-Manager.\-cpp.

\hypertarget{classmdt_port_manager_aaa0a474183bcae0fff4fb9ef43023c25}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!remove\-Threads@{remove\-Threads}}
\index{remove\-Threads@{remove\-Threads}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{remove\-Threads}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::remove\-Threads (
\begin{DoxyParamCaption}
\item[{bool}]{release\-Memory}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_aaa0a474183bcae0fff4fb9ef43023c25}


Detach threads from port and remove threads. 


\begin{DoxyParams}{Parameters}
{\em release\-Memory} & If true, all threads are deleted \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
Port manager must be closed (see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). 
\end{DoxyPrecond}


Definition at line 156 of file mdt\-Port\-Manager.\-cpp.



References from\-Thread\-New\-Frame\-Readen(), is\-Closed(), mdt\-Port\-Thread\-::is\-Reader(), on\-Threads\-Error\-Occured(), pm\-Connected\-Event(), and pv\-Threads.



Referenced by detach\-Port().

\hypertarget{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!restore\-Transaction@{restore\-Transaction}}
\index{restore\-Transaction@{restore\-Transaction}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{restore\-Transaction}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::restore\-Transaction (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Transaction} $\ast$}]{transaction}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a5fea4a9b8e94d38e8ec699dba05c7ca8}


Restore a transaction into pool. 

\begin{DoxyPrecond}{Precondition}
transaction must be a valid pointer (not Null) 

One transaction must be commited once (avoid corrupted double free) 
\end{DoxyPrecond}


Definition at line 310 of file mdt\-Port\-Manager.\-cpp.



Referenced by commit\-Frames(), flush\-Transactions\-Done(), flush\-Transactions\-Pending(), mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), readen\-Frame(), readen\-Frames(), mdt\-Device\-::restore\-Transaction(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request().

\hypertarget{classmdt_port_manager_ad56afb411ab5468005fca04767557ece}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!scan@{scan}}
\index{scan@{scan}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{scan}]{\setlength{\rightskip}{0pt plus 5cm}Q\-List$<$ {\bf mdt\-Port\-Info} $\ast$ $>$ mdt\-Port\-Manager\-::scan (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_ad56afb411ab5468005fca04767557ece}


Scan for available ports. 

This method is implemented is port's specific subclass. Default implementation returns a empty list.

Note that returned list must be freed by user after usage. (for.\-ex. with q\-Delet\-All() and Q\-List\-::clear() ). 

Reimplemented in \hyperlink{classmdt_serial_port_manager_a791572f869d1d605d0c4658ca4187260}{mdt\-Serial\-Port\-Manager}, \hyperlink{classmdt_usbtmc_port_manager_a992d1227810186d3c7dc166452e2e3b6}{mdt\-Usbtmc\-Port\-Manager}, and \hyperlink{classmdt_usb_port_manager_a3a2370c3a2d0353a880bf9b777728c3b}{mdt\-Usb\-Port\-Manager}.



Definition at line 67 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::scan().

\hypertarget{classmdt_port_manager_ad98399edba146af5cf32a9002094385c}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!send\-Data@{send\-Data}}
\index{send\-Data@{send\-Data}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{send\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int mdt\-Port\-Manager\-::send\-Data (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Transaction} $\ast$}]{transaction}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_ad98399edba146af5cf32a9002094385c}


Send data on port. 

At first, this method waits until the ready state is set calling \hyperlink{classmdt_port_manager_a6dc2798324521d177fb8f79d4f6c5f0f}{is\-Ready()} , a frame is available in port's write frames pool, and until a transaction is possible (see \hyperlink{classmdt_port_manager_ac04a12f8aa20ba04695083afce45a6cc}{wait\-Transaction\-Possible()} ). This wait will not break event loop, so no G\-U\-I freeze occurs. If port manager is stopped during this wait (unhandled error, stop request), this method returns.

Then, data contained in transaction will be passed to the \hyperlink{classmdt_port}{mdt\-Port}'s write queue by copy. This method returns immediatly after enqueue, and don't wait until data was written.


\begin{DoxyParams}{Parameters}
{\em transaction} & Transaction used to send data. Following members are used by this method\-:
\begin{DoxyItemize}
\item id \-: transaction will be added to pending transactions with this id, and current\-Transaction\-Id will be set with it.
\item data \-: will be sent to port.
\item is\-Query\-Reply\-Mode \-: if true, the transaction will be keeped in transactions done queue until \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} or \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} is called. Note\-: it's possible to force keeping all incomming data (wich also owerwrite this flag) by setting the global keep\-Transactions\-Done flag.
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Transaction I\-D on success or value $<$ 0 on error. In this implementation, the only possible error is \hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85eae50ff4a9393507ad39005ddc7d5be42f}{mdt\-Abstract\-Port\-::\-Write\-Canceled}, witch typically occurs when port manager stops. Some subclass can return a frame I\-D on success, or a other error. See subclass documentation for details. Note\-: on failure, the transaction is restored to pool. 
\end{DoxyReturn}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 

transaction must be a valid pointer, and not allready exists in transactions pending or transactions done queue.
\end{DoxyPrecond}
Subclass notes\-:\par
 This method can be reimplemented in subclass if needed. Typically usefull if some encoding is needed before the frame is submitted to port. A frame must be taken from port's write frames pool with \hyperlink{classmdt_abstract_port_abf093b67fddebffa4f3c52277b9a8cf7}{mdt\-Abstract\-Port\-::write\-Frames\-Pool()} dequeue() method (see Qt's Q\-Queue documentation for more details on dequeue() ), then added to port's write queue with \hyperlink{classmdt_abstract_port_a9a69eb2fc07d551ab37c011487fa319d}{mdt\-Abstract\-Port\-::add\-Frame\-To\-Write()} . If protocol supports frame identification (like M\-O\-D\-B\-U\-S's transaction I\-D or U\-S\-B\-T\-M\-C's b\-Tag), it should be returned here and incremented using \hyperlink{classmdt_port_manager_a4d009936a0a5130f3bfecb69fee4ce42}{increment\-Current\-Transaction\-Id()}. 

Reimplemented in \hyperlink{classmdt_modbus_tcp_port_manager_a208a3b2522795974836fd8aef406725a}{mdt\-Modbus\-Tcp\-Port\-Manager}, and \hyperlink{classmdt_usbtmc_port_manager_a205901666c797055bee1902bd1e1e09c}{mdt\-Usbtmc\-Port\-Manager}.



Definition at line 319 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Abstract\-Port\-::add\-Frame\-To\-Write(), add\-Transaction\-Pending(), mdt\-Frame\-::clear(), mdt\-Frame\-::clear\-Sub(), mdt\-Port\-Transaction\-::data(), mdt\-Port\-Transaction\-::id(), is\-Closed(), is\-Ready(), lock\-Port\-Mutex(), pv\-Port, restore\-Transaction(), transactions\-Done\-Contains(), unlock\-Port\-Mutex(), wait\-Transaction\-Possible(), mdt\-Abstract\-Port\-::\-Write\-Canceled, and mdt\-Abstract\-Port\-::write\-Frames\-Pool().



Referenced by send\-Data().

\hypertarget{classmdt_port_manager_a445b27f0819158f67f1bd548cdd2fedf}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!send\-Data@{send\-Data}}
\index{send\-Data@{send\-Data}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{send\-Data}]{\setlength{\rightskip}{0pt plus 5cm}int mdt\-Port\-Manager\-::send\-Data (
\begin{DoxyParamCaption}
\item[{const Q\-Byte\-Array \&}]{data, }
\item[{bool}]{query\-Reply\-Mode = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_a445b27f0819158f67f1bd548cdd2fedf}


Send data to port. 

Will increment the current transaction I\-D, get a new transaction, setup it and finally send it with \hyperlink{classmdt_port_manager_ad98399edba146af5cf32a9002094385c}{send\-Data(mdt\-Port\-Transaction$\ast$)}.


\begin{DoxyParams}{Parameters}
{\em data} & Data to write. \\
\hline
{\em query\-Reply\-Mode} & If true, reply will be keeped in transactions done queue until \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} or \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} is called. If false, behaviour depends on keep\-Transactions\-Done flag.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager_ad98399edba146af5cf32a9002094385c}{send\-Data(mdt\-Port\-Transaction$\ast$)} 
\end{DoxySeeAlso}


Reimplemented in \hyperlink{classmdt_modbus_tcp_port_manager_ac6ffcccbba23b1bda5cba2ae347793ba}{mdt\-Modbus\-Tcp\-Port\-Manager}.



Definition at line 365 of file mdt\-Port\-Manager.\-cpp.



References current\-Transaction\-Id(), get\-New\-Transaction(), increment\-Current\-Transaction\-Id(), pv\-Port, send\-Data(), mdt\-Port\-Transaction\-::set\-Data(), mdt\-Port\-Transaction\-::set\-Id(), and mdt\-Port\-Transaction\-::set\-Query\-Reply\-Mode().

\hypertarget{classmdt_port_manager_a3f1d25b2441c467c0de9908c73422a93}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!set\-Current\-Transaction\-Id@{set\-Current\-Transaction\-Id}}
\index{set\-Current\-Transaction\-Id@{set\-Current\-Transaction\-Id}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{set\-Current\-Transaction\-Id}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::set\-Current\-Transaction\-Id (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a3f1d25b2441c467c0de9908c73422a93}


Set the current transaction I\-D. 



Definition at line 631 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Usbtmc\-Port\-Manager\-::mdt\-Usbtmc\-Port\-Manager(), and open\-Port().

\hypertarget{classmdt_port_manager_a9adb5098766c9df588bc9978b00c5eb2}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!set\-Keep\-Transactions\-Done@{set\-Keep\-Transactions\-Done}}
\index{set\-Keep\-Transactions\-Done@{set\-Keep\-Transactions\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{set\-Keep\-Transactions\-Done}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::set\-Keep\-Transactions\-Done (
\begin{DoxyParamCaption}
\item[{bool}]{keep}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a9adb5098766c9df588bc9978b00c5eb2}


Force transactions done to be keeped. 

If keep is true, \hyperlink{classmdt_port_manager_a84d37b380080eb26e56c68424dedd958}{commit\-Frames()} will ignore the \hyperlink{classmdt_port_transaction_a9da1cc7a191cd21a2e532d277aa3c628}{mdt\-Port\-Transaction\-::is\-Query\-Reply\-Mode()} and allways keep transactions in done queue until \hyperlink{classmdt_port_manager_a830ae182d06dd6a52c43a7f45b9240ac}{readen\-Frame()} or \hyperlink{classmdt_port_manager_addd5dcae9644cea42a9871205af41796}{readen\-Frames()} is called. 

Definition at line 278 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::mdt\-Modbus\-Tcp\-Port\-Manager(), mdt\-Port\-Manager(), and mdt\-Usbtmc\-Port\-Manager\-::mdt\-Usbtmc\-Port\-Manager().

\hypertarget{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!set\-Port@{set\-Port}}
\index{set\-Port@{set\-Port}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{set\-Port}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::set\-Port (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Abstract\-Port} $\ast$}]{port}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}


Set port object. 

\begin{DoxyPrecond}{Precondition}
port must be a valid pointer to the expected class instance (for ex\-: \hyperlink{classmdt_serial_port}{mdt\-Serial\-Port}). 

Port manager must be closed (see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). 
\end{DoxyPrecond}


Definition at line 72 of file mdt\-Port\-Manager.\-cpp.



References is\-Closed(), and pv\-Port.



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::mdt\-Modbus\-Tcp\-Port\-Manager(), mdt\-Serial\-Port\-Manager\-::mdt\-Serial\-Port\-Manager(), and mdt\-Usb\-Port\-Manager\-::mdt\-Usb\-Port\-Manager().

\hypertarget{classmdt_port_manager_a7e2ef93ec2731e66aa2b2d5f7ce9bc1c}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!set\-Port\-Info@{set\-Port\-Info}}
\index{set\-Port\-Info@{set\-Port\-Info}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{set\-Port\-Info}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::set\-Port\-Info (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Info}}]{info}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a7e2ef93ec2731e66aa2b2d5f7ce9bc1c}


Set port info. 

Store given port info, and set port name to internall port object. (see \hyperlink{classmdt_port_info_ad456aac33dccc9b0583ed8aa4796cdf0}{mdt\-Port\-Info\-::port\-Name()} ).

Setting a port info can be usefull if other informations are needed later in application (f.\-ex. \hyperlink{classmdt_port_info_a38bcac67372782228a91d8e7dbf49211}{mdt\-Port\-Info\-::display\-Text()} ). You can get port informations later with \hyperlink{classmdt_port_manager_a88109b455fc5a5f5adf0636f7450143e}{port\-Info()}.

\begin{DoxyPrecond}{Precondition}
Port must be set before with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} 

Port manager must be closed (see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). 
\end{DoxyPrecond}


Definition at line 245 of file mdt\-Port\-Manager.\-cpp.



References is\-Closed(), mdt\-Port\-Info\-::port\-Name(), pv\-Port, and mdt\-Abstract\-Port\-::set\-Port\-Name().



Referenced by mdt\-Device\-Modbus\-Wago\-::connect\-To\-Device(), mdt\-Device\-Scpi\-::connect\-To\-Device(), and mdt\-Device\-Modbus\-::connect\-To\-Device().

\hypertarget{classmdt_port_manager_a2b2ed690cbba9f544c6ac1b46684e59a}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!set\-Port\-Name@{set\-Port\-Name}}
\index{set\-Port\-Name@{set\-Port\-Name}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{set\-Port\-Name}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::set\-Port\-Name (
\begin{DoxyParamCaption}
\item[{const Q\-String \&}]{port\-Name}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a2b2ed690cbba9f544c6ac1b46684e59a}


Set port name. 

Set the port name to internally port object. Does nothing else. To open the port, use \hyperlink{classmdt_port_manager_af1fb103ffafc227337a59c7e82f44fbc}{start()}.

\begin{DoxyPrecond}{Precondition}
Port must be set before with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} 

Port manager must be closed (see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). 
\end{DoxyPrecond}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} 
\end{DoxySeeAlso}


Definition at line 236 of file mdt\-Port\-Manager.\-cpp.



References is\-Closed(), pv\-Port, and mdt\-Abstract\-Port\-::set\-Port\-Name().



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::scan().

\hypertarget{classmdt_port_manager_af1fb103ffafc227337a59c7e82f44fbc}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!start@{start}}
\index{start@{start}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{start}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::start (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_manager_af1fb103ffafc227337a59c7e82f44fbc}


Start port manager. 

Will open port and start threads. This method returns once port manager is ready (see \hyperlink{classmdt_port_manager_a6dc2798324521d177fb8f79d4f6c5f0f}{is\-Ready()} ). Note\-: event loop continues to work during wait of ready state, G\-U\-I will also not freeze

\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_usb_port_manager_ac656805c6de08c9c6a2487291cf3f347}{mdt\-Usb\-Port\-Manager}.



Definition at line 182 of file mdt\-Port\-Manager.\-cpp.



References current\-State(), is\-Closed(), mdt\-Abstract\-Port\-::is\-Open(), is\-Ready(), open\-Port(), pm\-Start\-Threads\-Event(), Port\-Error, pv\-Port, stop(), Stopped, and Stopping.



Referenced by mdt\-Device\-Modbus\-Wago\-::connect\-To\-Device(), mdt\-Device\-Modbus\-::connect\-To\-Device(), mdt\-Modbus\-Tcp\-Port\-Manager\-::scan(), and mdt\-Usb\-Port\-Manager\-::start().

\hypertarget{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!start\-Transaction\-Timer@{start\-Transaction\-Timer}}
\index{start\-Transaction\-Timer@{start\-Transaction\-Timer}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{start\-Transaction\-Timer}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::start\-Transaction\-Timer (
\begin{DoxyParamCaption}
\item[{int}]{timeout}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}


Start transaction timer. 


\begin{DoxyParams}{Parameters}
{\em timeout} & Timeout \mbox{[}ms\mbox{]}\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}{transaction\-Timeout\-Occured()} 

\hyperlink{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}{pm\-Transaction\-Timeout\-Event()} 

on\-Transaction\-Timeout\-Occured() 

\hyperlink{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}{stop\-Transaction\-Timer()} 
\end{DoxySeeAlso}


Definition at line 770 of file mdt\-Port\-Manager.\-cpp.



Referenced by wait\-One\-Transaction\-Done(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a01da0634bc52a71c0df0d83fc166eeda}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!state\-Changed@{state\-Changed}}
\index{state\-Changed@{state\-Changed}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{state\-Changed}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::state\-Changed (
\begin{DoxyParamCaption}
\item[{int}]{state\-Id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a01da0634bc52a71c0df0d83fc166eeda}


Emitted each time the state changed. 

\hypertarget{classmdt_port_manager_ae00d513ed335fbd203852dcb7180005c}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!state\-Changed\-For\-Ui@{state\-Changed\-For\-Ui}}
\index{state\-Changed\-For\-Ui@{state\-Changed\-For\-Ui}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{state\-Changed\-For\-Ui}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::state\-Changed\-For\-Ui (
\begin{DoxyParamCaption}
\item[{int}]{state\-Id, }
\item[{const Q\-String \&}]{state\-Text, }
\item[{int}]{led\-Color\-Id, }
\item[{bool}]{led\-Is\-On}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_ae00d513ed335fbd203852dcb7180005c}


Emitted only if a state that must be notified is entered. 

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_state_machine}{mdt\-State\-Machine} 
\end{DoxySeeAlso}
\hypertarget{classmdt_port_manager_a6f6c6f8a8430d8631a08c765565db9ab}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!status\-Message\-Changed@{status\-Message\-Changed}}
\index{status\-Message\-Changed@{status\-Message\-Changed}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{status\-Message\-Changed}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::status\-Message\-Changed (
\begin{DoxyParamCaption}
\item[{const Q\-String \&}]{message, }
\item[{const Q\-String \&}]{details, }
\item[{int}]{timeout}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_manager_a6f6c6f8a8430d8631a08c765565db9ab}


Emitted when a new status message is to display. 

Typically used with mdt\-Device\-Status\-Widget. 

Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::try\-To\-Connect().

\hypertarget{classmdt_port_manager_aacbf87cc3d9c37c87e21696f8a6514bd}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!stop@{stop}}
\index{stop@{stop}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{stop}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::stop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_aacbf87cc3d9c37c87e21696f8a6514bd}


Stop port manager. 

Will stop threads and close port. This method returns once port manager is closed ( see \hyperlink{classmdt_port_manager_aeecbec49376838ab3547729636166d97}{is\-Closed()} ). Note\-: event loop continues to work during wait of ready state, G\-U\-I will also not freeze

\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_manager_afcd156b2d0c9d340999935efb6cd8cb6}{set\-Port()} before use of this method. 
\end{DoxyPrecond}


Definition at line 213 of file mdt\-Port\-Manager.\-cpp.



References close\-Port(), is\-Closed(), mdt\-Abstract\-Port\-::is\-Open(), pm\-Port\-Closed\-Event(), pm\-Stop\-Threads\-Event(), Port\-Closed, pv\-Port, Stopped, stop\-Transaction\-Timer(), and mdt\-State\-Machine\-::wait\-On\-State().



Referenced by mdt\-Device\-Modbus\-Wago\-::connect\-To\-Device(), mdt\-Device\-Scpi\-::connect\-To\-Device(), mdt\-Device\-Modbus\-::connect\-To\-Device(), detach\-Port(), mdt\-Device\-::disconnect\-From\-Device(), mdt\-Modbus\-Tcp\-Port\-Manager\-::scan(), start(), mdt\-Device\-Modbus\-::$\sim$mdt\-Device\-Modbus(), $\sim$mdt\-Port\-Manager(), and mdt\-Usb\-Port\-Manager\-::$\sim$mdt\-Usb\-Port\-Manager().

\hypertarget{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!stop\-Transaction\-Timer@{stop\-Transaction\-Timer}}
\index{stop\-Transaction\-Timer@{stop\-Transaction\-Timer}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{stop\-Transaction\-Timer}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::stop\-Transaction\-Timer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}


Stop transaction timer. 

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}{start\-Transaction\-Timer()} 

\hyperlink{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}{transaction\-Timeout\-Occured()} 

\hyperlink{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}{pm\-Transaction\-Timeout\-Event()} 

on\-Transaction\-Timeout\-Occured() 
\end{DoxySeeAlso}


Definition at line 778 of file mdt\-Port\-Manager.\-cpp.



Referenced by stop(), wait\-One\-Transaction\-Done(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a5869bcf6774a86fb9d3b00a0d4211bb5}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!transaction\-Done@{transaction\-Done}}
\index{transaction\-Done@{transaction\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{transaction\-Done}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Transaction} $\ast$ mdt\-Port\-Manager\-::transaction\-Done (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a5869bcf6774a86fb9d3b00a0d4211bb5}


Take transaction from D\-O\-N\-E queue matching id. 

\begin{DoxyReturn}{Returns}
A valid transaction if exists, else a Null pointer. 
\end{DoxyReturn}


Definition at line 742 of file mdt\-Port\-Manager.\-cpp.



References mdt\-Port\-Transaction\-::id().



Referenced by readen\-Frame().

\hypertarget{classmdt_port_manager_a18478707a9be7638b06cde48ced48297}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!transaction\-Pending@{transaction\-Pending}}
\index{transaction\-Pending@{transaction\-Pending}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{transaction\-Pending}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Transaction} $\ast$ mdt\-Port\-Manager\-::transaction\-Pending (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a18478707a9be7638b06cde48ced48297}


Take pending transaction matching id. 

\begin{DoxyReturn}{Returns}
A valid transaction if exists, else a Null pointer. 
\end{DoxyReturn}


Definition at line 700 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), and from\-Thread\-New\-Frame\-Readen().

\hypertarget{classmdt_port_manager_a3293066f4c3ed2e4b116f28dca8c5d64}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!transactions\-Done\-Contains@{transactions\-Done\-Contains}}
\index{transactions\-Done\-Contains@{transactions\-Done\-Contains}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{transactions\-Done\-Contains}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::transactions\-Done\-Contains (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a3293066f4c3ed2e4b116f28dca8c5d64}


Check if a transaction with given I\-D exists in done queue. 



Definition at line 728 of file mdt\-Port\-Manager.\-cpp.



Referenced by add\-Transaction\-Done(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!transaction\-Timeout\-Occured@{transaction\-Timeout\-Occured}}
\index{transaction\-Timeout\-Occured@{transaction\-Timeout\-Occured}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{transaction\-Timeout\-Occured}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::transaction\-Timeout\-Occured (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a04fc12f0dc02e981cac8dc56539e63d2}


Check if a transaction timeout occured. 

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager_a0be3429f901fc9bf4adee196035d2cee}{pm\-Transaction\-Timeout\-Event()} 

on\-Transaction\-Timeout\-Occured() 

\hyperlink{classmdt_port_manager_adeeba5a216174fcc1d01446a9537f40e}{start\-Transaction\-Timer()} 

\hyperlink{classmdt_port_manager_a1467c0bd28612ae3116f5daba08c0b84}{stop\-Transaction\-Timer()} 
\end{DoxySeeAlso}


Definition at line 786 of file mdt\-Port\-Manager.\-cpp.



Referenced by wait\-One\-Transaction\-Done(), and wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_a882e6bf95dac9cd4ab8cc93ecc524874}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!unlock\-Port\-Mutex@{unlock\-Port\-Mutex}}
\index{unlock\-Port\-Mutex@{unlock\-Port\-Mutex}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{unlock\-Port\-Mutex}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::unlock\-Port\-Mutex (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a882e6bf95dac9cd4ab8cc93ecc524874}


Unlock port's mutex. 

\begin{DoxyPrecond}{Precondition}
Port must be set with set\-Port before using this method 
\end{DoxyPrecond}


Definition at line 94 of file mdt\-Port\-Manager.\-cpp.



References pv\-Port, and mdt\-Abstract\-Port\-::unlock\-Mutex().



Referenced by mdt\-Usb\-Port\-Manager\-::from\-Thread\-Control\-Response\-Readen(), mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), from\-Thread\-New\-Frame\-Readen(), mdt\-Usb\-Port\-Manager\-::read\-Until\-Short\-Packet\-Received(), mdt\-Usb\-Port\-Manager\-::send\-Control\-Request(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request().

\hypertarget{classmdt_port_manager_aaa85e0200aba0e0f4392dfe01abae2cf}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!wait@{wait}}
\index{wait@{wait}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{wait}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Manager\-::wait (
\begin{DoxyParamCaption}
\item[{int}]{ms}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_aaa85e0200aba0e0f4392dfe01abae2cf}


Wait for some time. 

This will block the caller until ms milliseconds elapsed. This will not block event loop, i.\-e. no G\-U\-I freeze occurs.

Such wait method can be usfull if, for example, a device needs some time between two requests.

Note\-: this method should not be used to wait on a specific event (frame received, ...). For such problem, please considere the transaction A\-P\-I (in this class) and \hyperlink{classmdt_device}{mdt\-Device} witch give some helper methods and a A\-P\-I when developping new communication classes with devices.

Internally, a Q\-Timer is used. Please considere Qt documentation about time precisions and limitations. Note\-: \hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} is not designed for real time applications, but in mind to communicate in a easy way with devices.

For the story, a example with a Wago 750 I/\-O system\-: In multidiagtools test suite we do set/get tests on outputs. We wait confirmation of device for each request (see \hyperlink{classmdt_device}{mdt\-Device} for details). Some times test failed because the get didn't return the value set just before. By mesuring set and get times, we could see that it can take about 2\mbox{[}ms\mbox{]} -\/$>$ 40\mbox{[}ms\mbox{]}. This can be shorter than P\-L\-C needs to update its cache (read all I/\-O on bus, ...), and we had a old value in get reply. 

Definition at line 479 of file mdt\-Port\-Manager.\-cpp.



Referenced by mdt\-Device\-::wait().

\hypertarget{classmdt_port_manager_af60f089baded850018cbb90645c8e547}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!wait\-One\-Transaction\-Done@{wait\-One\-Transaction\-Done}}
\index{wait\-One\-Transaction\-Done@{wait\-One\-Transaction\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{wait\-One\-Transaction\-Done}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::wait\-One\-Transaction\-Done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_af60f089baded850018cbb90645c8e547}


Wait until current transaction is done. 

Use this method if protocol does not support frame I\-D.

Internally, it will wait until one transaction is available in done queue.

\begin{DoxyReturn}{Returns}
True if Ok, false on timeout or other error. 
\end{DoxyReturn}


Definition at line 436 of file mdt\-Port\-Manager.\-cpp.



References Busy, config(), current\-State(), is\-Ready(), pv\-Port, start\-Transaction\-Timer(), stop\-Transaction\-Timer(), and transaction\-Timeout\-Occured().

\hypertarget{classmdt_port_manager_a5551802de2c08632078f2cc0e2607913}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!wait\-Transaction\-Done@{wait\-Transaction\-Done}}
\index{wait\-Transaction\-Done@{wait\-Transaction\-Done}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{wait\-Transaction\-Done}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::wait\-Transaction\-Done (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_a5551802de2c08632078f2cc0e2607913}


Wait until a transaction is done. 

Will return when transaction with given id is done or after timeout.

This wait method does not break Qt's event loop, no G\-U\-I freeze occurs.

This method can return if timeout occurs, or for other reason depending on specific port (port timeout, read cancelled, ...).


\begin{DoxyParams}{Parameters}
{\em id} & Frame I\-D. Depending on protocol, this can be a transaction I\-D or what else. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if Ok, false on timeout or other error. If id was not found in transactions pending lists, a warning will be generated in \hyperlink{classmdt_error}{mdt\-Error} system, and false will be returned. On failure, transaction is restored to pool (see \hyperlink{classmdt_port_manager_a7e45b8e3475e5182ed12218616664d07}{on\-Threads\-Error\-Occured()} for details). 
\end{DoxyReturn}


Definition at line 381 of file mdt\-Port\-Manager.\-cpp.



References Busy, mdt\-Error\-::commit(), config(), current\-State(), is\-Ready(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, pm\-Unhandled\-Error\-Event(), pv\-Port, start\-Transaction\-Timer(), stop\-Transaction\-Timer(), transactions\-Done\-Contains(), transaction\-Timeout\-Occured(), and mdt\-Error\-::\-Warning.



Referenced by mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Hardware\-Node\-Address(), mdt\-Modbus\-Tcp\-Port\-Manager\-::get\-Register\-Values(), mdt\-Usbtmc\-Port\-Manager\-::send\-Query(), mdt\-Modbus\-Tcp\-Port\-Manager\-::set\-Register\-Values(), and mdt\-Device\-::wait\-Transaction\-Done().

\hypertarget{classmdt_port_manager_ac04a12f8aa20ba04695083afce45a6cc}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!wait\-Transaction\-Possible@{wait\-Transaction\-Possible}}
\index{wait\-Transaction\-Possible@{wait\-Transaction\-Possible}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{wait\-Transaction\-Possible}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Manager\-::wait\-Transaction\-Possible (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_ac04a12f8aa20ba04695083afce45a6cc}


Wait until transaction pending queue has less than maximum possible items. 

\begin{DoxyReturn}{Returns}
True on success, false if wait was interrupted. 
\end{DoxyReturn}


Definition at line 652 of file mdt\-Port\-Manager.\-cpp.



References is\-Closed(), is\-Ready(), and pv\-Port.



Referenced by mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), and mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request().

\hypertarget{classmdt_port_manager_af44b6e9876e6687b1d4fe7e05ffd5a91}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!write\-Thread@{write\-Thread}}
\index{write\-Thread@{write\-Thread}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{write\-Thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Port\-Thread} $\ast$ mdt\-Port\-Manager\-::write\-Thread (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_manager_af44b6e9876e6687b1d4fe7e05ffd5a91}


Returns instance of writer thread. 

Note that a Null pointer can be returned 

Definition at line 151 of file mdt\-Port\-Manager.\-cpp.



\subsection{Member Data Documentation}
\hypertarget{classmdt_port_manager_af856162aab4f1c5202c1dfb330fae538}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pv\-Port@{pv\-Port}}
\index{pv\-Port@{pv\-Port}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pv\-Port}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Abstract\-Port}$\ast$ mdt\-Port\-Manager\-::pv\-Port\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_af856162aab4f1c5202c1dfb330fae538}


Definition at line 912 of file mdt\-Port\-Manager.\-h.



Referenced by abort(), add\-Thread(), close\-Port(), mdt\-Serial\-Port\-Manager\-::config(), config(), detach\-Port(), flush(), mdt\-Usb\-Port\-Manager\-::flush\-In(), flush\-In(), mdt\-Usb\-Port\-Manager\-::flush\-Out(), flush\-Out(), mdt\-Usb\-Port\-Manager\-::from\-Thread\-Control\-Response\-Readen(), mdt\-Usbtmc\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), mdt\-Modbus\-Tcp\-Port\-Manager\-::from\-Thread\-New\-Frame\-Readen(), from\-Thread\-New\-Frame\-Readen(), lock\-Port\-Mutex(), mdt\-Port\-Manager(), mdt\-Usbtmc\-Port\-Manager\-::mdt\-Usbtmc\-Port\-Manager(), open\-Port(), mdt\-Serial\-Port\-Manager\-::port(), mdt\-Usb\-Port\-Manager\-::read\-Until\-Short\-Packet\-Received(), mdt\-Usb\-Port\-Manager\-::send\-Control\-Request(), mdt\-Usbtmc\-Port\-Manager\-::send\-Data(), mdt\-Modbus\-Tcp\-Port\-Manager\-::send\-Data(), send\-Data(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Request(), mdt\-Usbtmc\-Port\-Manager\-::send\-Read\-Status\-Byte\-Request(), set\-Port(), set\-Port\-Info(), set\-Port\-Name(), mdt\-Usb\-Port\-Manager\-::start(), start(), stop(), unlock\-Port\-Mutex(), wait\-One\-Transaction\-Done(), mdt\-Usb\-Port\-Manager\-::wait\-Readen\-Control\-Response(), wait\-Transaction\-Done(), wait\-Transaction\-Possible(), mdt\-Modbus\-Tcp\-Port\-Manager\-::$\sim$mdt\-Modbus\-Tcp\-Port\-Manager(), $\sim$mdt\-Port\-Manager(), mdt\-Serial\-Port\-Manager\-::$\sim$mdt\-Serial\-Port\-Manager(), and mdt\-Usb\-Port\-Manager\-::$\sim$mdt\-Usb\-Port\-Manager().

\hypertarget{classmdt_port_manager_a8e0d49b789f8b01d469e84b487799573}{\index{mdt\-Port\-Manager@{mdt\-Port\-Manager}!pv\-Threads@{pv\-Threads}}
\index{pv\-Threads@{pv\-Threads}!mdtPortManager@{mdt\-Port\-Manager}}
\subsubsection[{pv\-Threads}]{\setlength{\rightskip}{0pt plus 5cm}Q\-List$<${\bf mdt\-Port\-Thread}$\ast$$>$ mdt\-Port\-Manager\-::pv\-Threads\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_manager_a8e0d49b789f8b01d469e84b487799573}


Definition at line 913 of file mdt\-Port\-Manager.\-h.



Referenced by add\-Thread(), mdt\-Usbtmc\-Port\-Manager\-::mdt\-Usbtmc\-Port\-Manager(), remove\-Threads(), and mdt\-Usb\-Port\-Manager\-::start().



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/mdtport/\hyperlink{mdt_port_manager_8h}{mdt\-Port\-Manager.\-h}\item 
src/mdtport/\hyperlink{mdt_port_manager_8cpp}{mdt\-Port\-Manager.\-cpp}\end{DoxyCompactItemize}
