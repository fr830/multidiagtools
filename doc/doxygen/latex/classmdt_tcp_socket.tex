\hypertarget{classmdt_tcp_socket}{
\section{mdtTcpSocket Class Reference}
\label{classmdt_tcp_socket}\index{mdtTcpSocket@{mdtTcpSocket}}
}


Inheritance diagram for mdtTcpSocket:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=168pt]{classmdt_tcp_socket__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for mdtTcpSocket:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{classmdt_tcp_socket__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classmdt_tcp_socket_a826d1c8df5a852a396878587606812b8}{
void {\bfseries decrementTransactionsCounter} ()}
\label{classmdt_tcp_socket_a826d1c8df5a852a396878587606812b8}

\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classmdt_tcp_socket_aeed1a50725a8e61f86de2bf67a92feb8}{
{\bfseries mdtTcpSocket} (QObject $\ast$parent=0)}
\label{classmdt_tcp_socket_aeed1a50725a8e61f86de2bf67a92feb8}

\item 
void \hyperlink{classmdt_tcp_socket_aa5b229a668c0d9b083f8eec8efe4636f}{connectToHost} (const QString \&hostName, int hostPort)
\begin{DoxyCompactList}\small\item\em Abort the waiting functions. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_tcp_socket_a8a57e4b49f56c301c5f8d7a9ec191e87}{setThreadObjects} (QTcpSocket $\ast$socket, \hyperlink{classmdt_tcp_socket_thread}{mdtTcpSocketThread} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Set the socket. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_tcp_socket_aae23057f2e0ee326d0fee78ffe3f00f9}{setReadTimeout} (int timeout)
\begin{DoxyCompactList}\small\item\em Set the read data timeout. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_tcp_socket_ac59d2dfdf405b5382f0f20d5b9f75fd0}{setWriteTimeout} (int timeout)
\begin{DoxyCompactList}\small\item\em Set the write data timeout. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_tcp_socket_a93984277418aee53633bd28249f484d1}{beginNewTransaction} ()
\begin{DoxyCompactList}\small\item\em Start a new transaction. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_tcp_socket_a4f81d3552d7e2a33d2e1bf2e84beb063}{waitForNewTransaction} ()
\begin{DoxyCompactList}\small\item\em Block until a new transaction starts. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_tcp_socket_a381bf5194cf180ca95f5f4bae730f73c}{waitForReadyRead} ()
\begin{DoxyCompactList}\small\item\em Wait until data is available on port. \end{DoxyCompactList}\item 
qint64 \hyperlink{classmdt_tcp_socket_a78842bc5ddcac2d96fb368ee575214cd}{read} (char $\ast$data, qint64 maxSize)
\begin{DoxyCompactList}\small\item\em Read data from port. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_tcp_socket_a91ada4fd18d31646c2a4d630b8f9ff21}{waitEventWriteReady} ()
\begin{DoxyCompactList}\small\item\em Wait until data can be written to port. \end{DoxyCompactList}\item 
qint64 \hyperlink{classmdt_tcp_socket_adbf2db44b291127a499d9f8720beb632}{write} (const char $\ast$data, qint64 maxSize)
\begin{DoxyCompactList}\small\item\em Write data to port. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classmdt_tcp_socket_a93984277418aee53633bd28249f484d1}{
\index{mdtTcpSocket@{mdtTcpSocket}!beginNewTransaction@{beginNewTransaction}}
\index{beginNewTransaction@{beginNewTransaction}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{beginNewTransaction}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::beginNewTransaction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classmdt_tcp_socket_a93984277418aee53633bd28249f484d1}


Start a new transaction. 

Mutex is locked by this method. \hypertarget{classmdt_tcp_socket_aa5b229a668c0d9b083f8eec8efe4636f}{
\index{mdtTcpSocket@{mdtTcpSocket}!connectToHost@{connectToHost}}
\index{connectToHost@{connectToHost}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{connectToHost}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::connectToHost (
\begin{DoxyParamCaption}
\item[{const QString \&}]{hostName, }
\item[{int}]{hostPort}
\end{DoxyParamCaption}
)}}
\label{classmdt_tcp_socket_aa5b229a668c0d9b083f8eec8efe4636f}


Abort the waiting functions. 

This method is called from main thread (\hyperlink{classmdt_port_thread_a5746ea96689ed80179751ad1353f0b39}{mdtPortThread::stop()}), and cause the system's wait functions to be aborted. Example are select() or ioctl() on POSIX. On Windows, the appropriate event of WaitForMultipleObjects() should be set.

The mutex is not handled by this method.void abortWaiting();

Connect to host

Use this method to start a connection to a host.\par
 Mutex is locked by this method. 
\begin{DoxyParams}{Parameters}
{\em hostName} & Hostname or IP address \\
\hline
{\em hostPort} & Port \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
hostPort must be $>$ 0
\end{DoxyPrecond}
void mdtTcpSocket::abortWaiting() \{ Q\_\-ASSERT(pvNativePthreadObject != 0);

Set aborting flag and send the signal /pvAbortingWaitEventCtl = true; pthread\_\-kill(pvNativePthreadObject, SIGALRM); \} \hypertarget{classmdt_tcp_socket_a78842bc5ddcac2d96fb368ee575214cd}{
\index{mdtTcpSocket@{mdtTcpSocket}!read@{read}}
\index{read@{read}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}qint64 mdtTcpSocket::read (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{data, }
\item[{qint64}]{maxSize}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_a78842bc5ddcac2d96fb368ee575214cd}


Read data from port. 

This method is called from \hyperlink{classmdt_port_read_thread}{mdtPortReadThread} , and should not be used directly.

Mutex is not handled by this method.

Subclass notes:\par
 This method must be implemented in subclass.\par


\begin{DoxyReturn}{Returns}
Number of bytes readen, or a error $<$ 0 
\end{DoxyReturn}


Implements \hyperlink{classmdt_abstract_port_a9d9c45220d5328c9856a2445557fe970}{mdtAbstractPort}.

\hypertarget{classmdt_tcp_socket_aae23057f2e0ee326d0fee78ffe3f00f9}{
\index{mdtTcpSocket@{mdtTcpSocket}!setReadTimeout@{setReadTimeout}}
\index{setReadTimeout@{setReadTimeout}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{setReadTimeout}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::setReadTimeout (
\begin{DoxyParamCaption}
\item[{int}]{timeout}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_aae23057f2e0ee326d0fee78ffe3f00f9}


Set the read data timeout. 

The mutex is not handled by this method.

Subclass notes:\par
 This method must be re-\/implemented in subclass. The subclass can convert and store the value in system specific type (f.ex: timeval struct on Posix)


\begin{DoxyParams}{Parameters}
{\em timeout} & Timeout \mbox{[}ms\mbox{]}. A value of -\/1 means a infinite timeout. \\
\hline
\end{DoxyParams}


Implements \hyperlink{classmdt_abstract_port_a6589b04467e0073d18ba872201bdcd84}{mdtAbstractPort}.

\hypertarget{classmdt_tcp_socket_a8a57e4b49f56c301c5f8d7a9ec191e87}{
\index{mdtTcpSocket@{mdtTcpSocket}!setThreadObjects@{setThreadObjects}}
\index{setThreadObjects@{setThreadObjects}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{setThreadObjects}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::setThreadObjects (
\begin{DoxyParamCaption}
\item[{QTcpSocket $\ast$}]{socket, }
\item[{{\bf mdtTcpSocketThread} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}
\label{classmdt_tcp_socket_a8a57e4b49f56c301c5f8d7a9ec191e87}


Set the socket. 

QTcpSocket must be created from thread on witch it will be used. In this case, the \hyperlink{classmdt_tcp_socket_thread}{mdtTcpSocketThread} create the instance.\par
 This method will be called to store this instance and an instance of the thread itself. Note: should not be used. \begin{DoxyPrecond}{Precondition}
socket must be a valid pointer 

thread must be a valid pointer 
\end{DoxyPrecond}
\begin{DoxySeeAlso}{See also}
\hyperlink{classmdt_tcp_socket_thread}{mdtTcpSocketThread} 
\end{DoxySeeAlso}
\hypertarget{classmdt_tcp_socket_ac59d2dfdf405b5382f0f20d5b9f75fd0}{
\index{mdtTcpSocket@{mdtTcpSocket}!setWriteTimeout@{setWriteTimeout}}
\index{setWriteTimeout@{setWriteTimeout}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{setWriteTimeout}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::setWriteTimeout (
\begin{DoxyParamCaption}
\item[{int}]{timeout}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_ac59d2dfdf405b5382f0f20d5b9f75fd0}


Set the write data timeout. 

The mutex is not handled by this method.

Subclass notes:\par
 This method must be re-\/implemented in subclass. The subclass can convert and store the value in system specific type (f.ex: timeval struct on Posix)


\begin{DoxyParams}{Parameters}
{\em timeout} & Timeout \mbox{[}ms\mbox{]}. A value of -\/1 means a infinite timeout. \\
\hline
\end{DoxyParams}


Implements \hyperlink{classmdt_abstract_port_a12eb422d52ebb09a650f8497b258c2e7}{mdtAbstractPort}.

\hypertarget{classmdt_tcp_socket_a91ada4fd18d31646c2a4d630b8f9ff21}{
\index{mdtTcpSocket@{mdtTcpSocket}!waitEventWriteReady@{waitEventWriteReady}}
\index{waitEventWriteReady@{waitEventWriteReady}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{waitEventWriteReady}]{\setlength{\rightskip}{0pt plus 5cm}bool mdtTcpSocket::waitEventWriteReady (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_a91ada4fd18d31646c2a4d630b8f9ff21}


Wait until data can be written to port. 

This method is called from \hyperlink{classmdt_port_write_thread}{mdtPortWriteThread} , and should not be used directly.\par
 Mutex must be locked before calling this method with \hyperlink{classmdt_abstract_port_a6bf2ecdcf894da3929a22eb8793a9fe3}{lockMutex()}. The mutex is locked when method returns.

Subclass notes:\par
 This method must be re-\/implemented in subclass.\par
 Notes about mutex handling:
\begin{DoxyItemize}
\item Mutex must be released during wait, and relocked befor return.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
False on error, in this case, the reader thread will be stopped. 
\end{DoxyReturn}


Implements \hyperlink{classmdt_abstract_port_a7773bc21c63ce6a275f5a0889935ac83}{mdtAbstractPort}.

\hypertarget{classmdt_tcp_socket_a4f81d3552d7e2a33d2e1bf2e84beb063}{
\index{mdtTcpSocket@{mdtTcpSocket}!waitForNewTransaction@{waitForNewTransaction}}
\index{waitForNewTransaction@{waitForNewTransaction}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{waitForNewTransaction}]{\setlength{\rightskip}{0pt plus 5cm}void mdtTcpSocket::waitForNewTransaction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classmdt_tcp_socket_a4f81d3552d7e2a33d2e1bf2e84beb063}


Block until a new transaction starts. 

Note: used by thread , should not be used directly.\par
 Mutex is locked by this method. \begin{DoxySeeAlso}{See also}
\hyperlink{classmdt_tcp_socket_thread}{mdtTcpSocketThread} 
\end{DoxySeeAlso}
\hypertarget{classmdt_tcp_socket_a381bf5194cf180ca95f5f4bae730f73c}{
\index{mdtTcpSocket@{mdtTcpSocket}!waitForReadyRead@{waitForReadyRead}}
\index{waitForReadyRead@{waitForReadyRead}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{waitForReadyRead}]{\setlength{\rightskip}{0pt plus 5cm}bool mdtTcpSocket::waitForReadyRead (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_a381bf5194cf180ca95f5f4bae730f73c}


Wait until data is available on port. 

This method is called from \hyperlink{classmdt_port_read_thread}{mdtPortReadThread} , and should not be used directly.\par
 Mutex must be locked before calling this method with \hyperlink{classmdt_abstract_port_a6bf2ecdcf894da3929a22eb8793a9fe3}{lockMutex()}. The mutex is locked when method returns.

Subclass notes:\par
 This method must be re-\/implemented in subclass. The read timeout state must be updated with \hyperlink{classmdt_abstract_port_a0fc7317e988d5dea53a999cd1bf4faa9}{updateReadTimeoutState()}\par
 Notes about mutex handling:
\begin{DoxyItemize}
\item Mutex must be released during wait, and relocked befor return.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
False on error, in this case, the reader thread will emit errorOccured()
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{classmdt_port_thread}{mdtPortThread} 

\hyperlink{classmdt_port_config}{mdtPortConfig} 

\hyperlink{classmdt_tcp_socket_thread}{mdtTcpSocketThread} 
\end{DoxySeeAlso}


Implements \hyperlink{classmdt_abstract_port_a848e3c86aa6ec480e8c471655fbcf5c5}{mdtAbstractPort}.

\hypertarget{classmdt_tcp_socket_adbf2db44b291127a499d9f8720beb632}{
\index{mdtTcpSocket@{mdtTcpSocket}!write@{write}}
\index{write@{write}!mdtTcpSocket@{mdtTcpSocket}}
\subsubsection[{write}]{\setlength{\rightskip}{0pt plus 5cm}qint64 mdtTcpSocket::write (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{data, }
\item[{qint64}]{maxSize}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classmdt_tcp_socket_adbf2db44b291127a499d9f8720beb632}


Write data to port. 

This method is called from \hyperlink{classmdt_port_write_thread}{mdtPortWriteThread} , and should not be used directly.

Mutex is not handled by this method.

Subclass notes:\par
 This method must be implemented in subclass.\par


\begin{DoxyReturn}{Returns}
Number of bytes written, or $<$0 on error 
\end{DoxyReturn}


Implements \hyperlink{classmdt_abstract_port_a64d4802975a76474b9196c91f57a6d90}{mdtAbstractPort}.



The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/mdtport/mdtTcpSocket.h\item 
src/mdtport/mdtTcpSocket.cpp\end{DoxyCompactItemize}
