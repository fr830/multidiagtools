\hypertarget{classmdt_port_thread}{\section{mdt\-Port\-Thread Class Reference}
\label{classmdt_port_thread}\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}}
}


{\ttfamily \#include $<$mdt\-Port\-Thread.\-h$>$}



Inheritance diagram for mdt\-Port\-Thread\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classmdt_port_thread__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for mdt\-Port\-Thread\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classmdt_port_thread__coll__graph}
\end{center}
\end{figure}
\subsection*{Signals}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classmdt_port_thread_abb7234a12814f5c7c98bd6c1c2ccb776}{read\-Process\-Begin} ()
\begin{DoxyCompactList}\small\item\em Emitted when a read process begins. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_aa01aac7e1a26deb823be40e6cb01b255}{write\-Process\-Begin} ()
\begin{DoxyCompactList}\small\item\em Emitted when a write process begins. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}{new\-Frame\-Readen} ()
\begin{DoxyCompactList}\small\item\em Emited when a new frame is available. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}{error\-Occured} (int error)
\begin{DoxyCompactList}\small\item\em Emitted on error. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_ae71ae3aa58eb1f409a2b128e6ef3148b}{ready} (\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Emitted when thread is started and ready. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a4266192826f09d8186ee8f9b646ac089}{finished} (\hyperlink{classmdt_port_thread}{mdt\-Port\-Thread} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Emitted when thread has finished executing. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a88070ed43976a83b6e4d289d6f1827bd}{connected} ()
\begin{DoxyCompactList}\small\item\em Emitted when connection with device is done. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmdt_port_thread_aa20869c68d7a016f9e547464f0d8b71e}{mdt\-Port\-Thread} (Q\-Object $\ast$parent=0)
\item 
virtual \hyperlink{classmdt_port_thread_a554615870b4c3b18af73d2ab7262800d}{$\sim$mdt\-Port\-Thread} ()
\item 
virtual void \hyperlink{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}{set\-Port} (\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} $\ast$\hyperlink{classmdt_port_thread_a97bff8cf6aca37d8858cc4e5c9294cae}{port})
\begin{DoxyCompactList}\small\item\em Set the port instance. \end{DoxyCompactList}\item 
\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} $\ast$ \hyperlink{classmdt_port_thread_a97bff8cf6aca37d8858cc4e5c9294cae}{port} ()
\begin{DoxyCompactList}\small\item\em Get port instance. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_thread_a29b434534a5564efbd9dfe570a61b143}{detach\-Port} (bool release\-Memory)
\begin{DoxyCompactList}\small\item\em Detach the port from thread. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a5a5c1290eaa43182d69c3f39eadbec00}{start} ()
\begin{DoxyCompactList}\small\item\em Start the thread. \end{DoxyCompactList}\item 
virtual void \hyperlink{classmdt_port_thread_a5746ea96689ed80179751ad1353f0b39}{stop} ()
\begin{DoxyCompactList}\small\item\em Stop the running thread. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_aca7473f73c6b68fe8c3e1cfc349240e7}{wait\-Ready} ()
\begin{DoxyCompactList}\small\item\em Wait until thread is ready. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a621c0748a16bc9ee15983ef488314c85}{wait\-Finished} ()
\begin{DoxyCompactList}\small\item\em Wait until thread is finished. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_thread_ae1becf17263dd9fbf5dfcc6c51eddd72}{is\-Running} () const 
\begin{DoxyCompactList}\small\item\em Returns true if the thread is running. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_ad9bcfaa66fba25512f2677a7e320c6c8}{set\-Running\-Flag} (bool running)
\begin{DoxyCompactList}\small\item\em Set the running flag. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_thread_abce96e61e09780841b729f28ab9054f0}{running\-Flag\-Set} () const 
\begin{DoxyCompactList}\small\item\em Get the running flag. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_port_thread_a55d7ef615447823bf9878492a2c88fd4}{is\-Finished} () const 
\begin{DoxyCompactList}\small\item\em Returns false if the thread is running. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classmdt_port_thread_acdb3d96287c571cc08ef39860dc324b1}{is\-Reader} () const 
\begin{DoxyCompactList}\small\item\em Returns true if this thread reads data and send the \hyperlink{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}{new\-Frame\-Readen()} signal. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classmdt_port_thread_a0122a12262052cf3643241a3eaa31c58}{is\-Writer} () const 
\begin{DoxyCompactList}\small\item\em Returns true if this thread writes date. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classmdt_port_thread_aaf671b84f7c1fb508ff9221dccee4c15}{handles\-Timeout} () const 
\begin{DoxyCompactList}\small\item\em Returns true is thread handles timeout(s) itself. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_port_thread_a30bdd11ef16d4f3321921c9d9b26399d}{notify\-Error} (\hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85e}{mdt\-Abstract\-Port\-::error\-\_\-t} error, bool renotify\-Same\-Error=false)
\begin{DoxyCompactList}\small\item\em Emit the \hyperlink{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}{error\-Occured()} signal if new error is different from current. \end{DoxyCompactList}\item 
\hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85e}{mdt\-Abstract\-Port\-::error\-\_\-t} \hyperlink{classmdt_port_thread_adbc2d86162c23401e75184407b8c9428}{current\-Error} () const 
\begin{DoxyCompactList}\small\item\em Get current error. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85e}{mdt\-Abstract\-Port\-::error\-\_\-t} \hyperlink{classmdt_port_thread_abee1d2f9b67ca37cfd13e108ca978b36}{reconnect} (bool notify=true)
\begin{DoxyCompactList}\small\item\em Try to reconnect to device/peer. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classmdt_port_thread_a01d2362e0dfcece4cba242cb586d8d1c}{sigaction\-Handle} (int signum)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
volatile bool \hyperlink{classmdt_port_thread_a59735ef01b761361b1055a0356be525a}{pv\-Running}
\item 
\hyperlink{classmdt_abstract_port}{mdt\-Abstract\-Port} $\ast$ \hyperlink{classmdt_port_thread_af5c4bed0c9fb012f220fba013d0f69b8}{pv\-Port}
\item 
pthread\-\_\-t \hyperlink{classmdt_port_thread_a7154af7d387eecaea113ddb5900ff23c}{pv\-Native\-Pthread\-Object}
\item 
struct sigaction \hyperlink{classmdt_port_thread_ae22f83fd56b06cdaa9b77abafe85a6b4}{pv\-Sigaction}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 36 of file mdt\-Port\-Thread.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classmdt_port_thread_aa20869c68d7a016f9e547464f0d8b71e}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!mdt\-Port\-Thread@{mdt\-Port\-Thread}}
\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{mdt\-Port\-Thread}]{\setlength{\rightskip}{0pt plus 5cm}mdt\-Port\-Thread\-::mdt\-Port\-Thread (
\begin{DoxyParamCaption}
\item[{Q\-Object $\ast$}]{parent = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_aa20869c68d7a016f9e547464f0d8b71e}


Definition at line 30 of file mdt\-Port\-Thread.\-cpp.



References finished(), pv\-Native\-Pthread\-Object, pv\-Port, pv\-Running, pv\-Sigaction, sigaction\-Handle(), and mdt\-Abstract\-Port\-::\-Unhandled\-Error.

\hypertarget{classmdt_port_thread_a554615870b4c3b18af73d2ab7262800d}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!$\sim$mdt\-Port\-Thread@{$\sim$mdt\-Port\-Thread}}
\index{$\sim$mdt\-Port\-Thread@{$\sim$mdt\-Port\-Thread}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{$\sim$mdt\-Port\-Thread}]{\setlength{\rightskip}{0pt plus 5cm}mdt\-Port\-Thread\-::$\sim$mdt\-Port\-Thread (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_a554615870b4c3b18af73d2ab7262800d}


Definition at line 50 of file mdt\-Port\-Thread.\-cpp.



References is\-Running(), and stop().



\subsection{Member Function Documentation}
\hypertarget{classmdt_port_thread_a88070ed43976a83b6e4d289d6f1827bd}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!connected@{connected}}
\index{connected@{connected}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{connected}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::connected (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_a88070ed43976a83b6e4d289d6f1827bd}


Emitted when connection with device is done. 

Notes\-:
\begin{DoxyItemize}
\item Disconnection, connection, etc... are notified as error
\item Some threads does not send this signal, because device connection is not handled directly by port protocol. 
\end{DoxyItemize}

Referenced by reconnect().

\hypertarget{classmdt_port_thread_adbc2d86162c23401e75184407b8c9428}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!current\-Error@{current\-Error}}
\index{current\-Error@{current\-Error}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{current\-Error}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Abstract\-Port\-::error\-\_\-t} mdt\-Port\-Thread\-::current\-Error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_thread_adbc2d86162c23401e75184407b8c9428}


Get current error. 

This is used by \hyperlink{classmdt_port_manager}{mdt\-Port\-Manager}.

Port's mutex is not handled by this method. 

Definition at line 225 of file mdt\-Port\-Thread.\-cpp.

\hypertarget{classmdt_port_thread_a29b434534a5564efbd9dfe570a61b143}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!detach\-Port@{detach\-Port}}
\index{detach\-Port@{detach\-Port}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{detach\-Port}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::detach\-Port (
\begin{DoxyParamCaption}
\item[{bool}]{release\-Memory}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_a29b434534a5564efbd9dfe570a61b143}


Detach the port from thread. 


\begin{DoxyParams}{Parameters}
{\em release\-Memory} & If true, the port object that was set with \hyperlink{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}{set\-Port()} will be deleted. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
The thread must not running 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_usb_port_thread_a99070e7dba4bd7939b054cddbd66979f}{mdt\-Usb\-Port\-Thread}.



Definition at line 70 of file mdt\-Port\-Thread.\-cpp.



References pv\-Port.



Referenced by mdt\-Usb\-Port\-Thread\-::detach\-Port().

\hypertarget{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!error\-Occured@{error\-Occured}}
\index{error\-Occured@{error\-Occured}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{error\-Occured}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::error\-Occured (
\begin{DoxyParamCaption}
\item[{int}]{error}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}


Emitted on error. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000035}{Todo}]Adapt threads + port managers\end{DoxyRefDesc}


When a error occurs, this signal is emited.

The error is one of the \hyperlink{classmdt_abstract_port_ad4121bb930c95887e77f8bafa065a85e}{mdt\-Abstract\-Port\-::error\-\_\-t}.

\hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} uses this signal. 

Referenced by notify\-Error().

\hypertarget{classmdt_port_thread_a4266192826f09d8186ee8f9b646ac089}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!finished@{finished}}
\index{finished@{finished}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{finished}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::finished (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Thread} $\ast$}]{thread}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_a4266192826f09d8186ee8f9b646ac089}


Emitted when thread has finished executing. 



Referenced by mdt\-Port\-Thread().

\hypertarget{classmdt_port_thread_aaf671b84f7c1fb508ff9221dccee4c15}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!handles\-Timeout@{handles\-Timeout}}
\index{handles\-Timeout@{handles\-Timeout}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{handles\-Timeout}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::handles\-Timeout (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_aaf671b84f7c1fb508ff9221dccee4c15}


Returns true is thread handles timeout(s) itself. 

For example, \hyperlink{classmdt_usb_port_thread}{mdt\-Usb\-Port\-Thread} and subclasses handles timeout itself. \hyperlink{classmdt_port_read_thread}{mdt\-Port\-Read\-Thread} does not.

\hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} uses this flag to know how to deal with timeouts.

This implementation returns false. 

Reimplemented in \hyperlink{classmdt_usb_port_thread_aeaa2dabc53e57f6b7cf7077d113c7f40}{mdt\-Usb\-Port\-Thread}, \hyperlink{classmdt_port_read_thread_afa42f86f3fed878b8f44cacb3a2f41af}{mdt\-Port\-Read\-Thread}, and \hyperlink{classmdt_tcp_socket_thread_aa14c9838dfb8d2defac449b8b58bbc7c}{mdt\-Tcp\-Socket\-Thread}.



Definition at line 211 of file mdt\-Port\-Thread.\-cpp.



Referenced by mdt\-Port\-Manager\-::add\-Thread().

\hypertarget{classmdt_port_thread_a55d7ef615447823bf9878492a2c88fd4}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!is\-Finished@{is\-Finished}}
\index{is\-Finished@{is\-Finished}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{is\-Finished}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::is\-Finished (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_thread_a55d7ef615447823bf9878492a2c88fd4}


Returns false if the thread is running. 

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_thread_ae1becf17263dd9fbf5dfcc6c51eddd72}{is\-Running()} 
\end{DoxySeeAlso}


Definition at line 185 of file mdt\-Port\-Thread.\-cpp.



References mdt\-Abstract\-Port\-::lock\-Mutex(), pv\-Port, pv\-Running, and mdt\-Abstract\-Port\-::unlock\-Mutex().



Referenced by wait\-Finished().

\hypertarget{classmdt_port_thread_acdb3d96287c571cc08ef39860dc324b1}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!is\-Reader@{is\-Reader}}
\index{is\-Reader@{is\-Reader}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{is\-Reader}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::is\-Reader (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_acdb3d96287c571cc08ef39860dc324b1}


Returns true if this thread reads data and send the \hyperlink{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}{new\-Frame\-Readen()} signal. 

\hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} can handle many threads. It needs to know wich one will send the \hyperlink{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}{new\-Frame\-Readen()} signal, so it can connect it to his slot.

Default implementation returns allways false.

This method should be implemented in reader subclass. 

Reimplemented in \hyperlink{classmdt_usb_port_thread_aed82b57c84745f1e2391750697db1022}{mdt\-Usb\-Port\-Thread}, \hyperlink{classmdt_port_read_thread_a0138d613b61056c9f8373331de2d9a84}{mdt\-Port\-Read\-Thread}, \hyperlink{classmdt_port_write_thread_ac37bb988773f624def51e841998a2f1e}{mdt\-Port\-Write\-Thread}, \hyperlink{classmdt_tcp_socket_thread_a3224f12c8ff8d695975030f3f6215010}{mdt\-Tcp\-Socket\-Thread}, and \hyperlink{classmdt_serial_port_ctl_thread_ab87413cedc8d0540eac553e55a3f6407}{mdt\-Serial\-Port\-Ctl\-Thread}.



Definition at line 201 of file mdt\-Port\-Thread.\-cpp.



Referenced by mdt\-Port\-Manager\-::add\-Thread(), and mdt\-Port\-Manager\-::remove\-Threads().

\hypertarget{classmdt_port_thread_ae1becf17263dd9fbf5dfcc6c51eddd72}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!is\-Running@{is\-Running}}
\index{is\-Running@{is\-Running}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{is\-Running}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::is\-Running (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_thread_ae1becf17263dd9fbf5dfcc6c51eddd72}


Returns true if the thread is running. 

This function overloads the Q\-Thread\-::is\-Running() function. Note for subclass\-: when the thread is started and ready, the private member pv\-Running must be set to true. 

Definition at line 157 of file mdt\-Port\-Thread.\-cpp.



References mdt\-Abstract\-Port\-::lock\-Mutex(), pv\-Port, pv\-Running, and mdt\-Abstract\-Port\-::unlock\-Mutex().



Referenced by wait\-Ready(), and $\sim$mdt\-Port\-Thread().

\hypertarget{classmdt_port_thread_a0122a12262052cf3643241a3eaa31c58}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!is\-Writer@{is\-Writer}}
\index{is\-Writer@{is\-Writer}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{is\-Writer}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::is\-Writer (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_a0122a12262052cf3643241a3eaa31c58}


Returns true if this thread writes date. 

Is used by \hyperlink{classmdt_port_thread_a5746ea96689ed80179751ad1353f0b39}{mdt\-Port\-Thread\-::stop()} to know if \hyperlink{classmdt_abstract_port_ae67c815f68317c70e398eaa86622af6b}{mdt\-Abstract\-Port\-::abort\-Frame\-To\-Write\-Wait()} must be called.

Default implementation returns false 

Reimplemented in \hyperlink{classmdt_usb_port_thread_a74258f300967b5dea1fbfa9a0ccab38a}{mdt\-Usb\-Port\-Thread}, \hyperlink{classmdt_port_write_thread_ad2508c3a2433383e2de705e9f3d2e602}{mdt\-Port\-Write\-Thread}, and \hyperlink{classmdt_tcp_socket_thread_a014ad2b3a5fbe7031eeb1d42d8f0767d}{mdt\-Tcp\-Socket\-Thread}.



Definition at line 206 of file mdt\-Port\-Thread.\-cpp.



Referenced by mdt\-Port\-Manager\-::add\-Thread(), and stop().

\hypertarget{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!new\-Frame\-Readen@{new\-Frame\-Readen}}
\index{new\-Frame\-Readen@{new\-Frame\-Readen}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{new\-Frame\-Readen}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::new\-Frame\-Readen (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_a7fc2245c753fd65e1beffec211c41461}


Emited when a new frame is available. 

This signal is emited when a new frame is available.

To get the frame, the simplest way is to use a \hyperlink{classmdt_port_manager}{mdt\-Port\-Manager}.

It's also possible to use \hyperlink{classmdt_port}{mdt\-Port}, but this solution needs to handle the mutex, verify the readen queue state, ...

\begin{DoxySeeAlso}{See Also}
\hyperlink{classmdt_port_manager}{mdt\-Port\-Manager} 

\hyperlink{classmdt_port}{mdt\-Port} 
\end{DoxySeeAlso}
\hypertarget{classmdt_port_thread_a30bdd11ef16d4f3321921c9d9b26399d}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!notify\-Error@{notify\-Error}}
\index{notify\-Error@{notify\-Error}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{notify\-Error}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::notify\-Error (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Abstract\-Port\-::error\-\_\-t}}]{error, }
\item[{bool}]{renotify\-Same\-Error = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_a30bdd11ef16d4f3321921c9d9b26399d}


Emit the \hyperlink{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}{error\-Occured()} signal if new error is different from current. 


\begin{DoxyParams}{Parameters}
{\em renotify\-Same\-Error} & For some cases, the same error must be notified each time it happens. If this flag is true, signal is emitted without checking previous error. \\
\hline
\end{DoxyParams}


Definition at line 216 of file mdt\-Port\-Thread.\-cpp.



References error\-Occured().



Referenced by mdt\-Port\-Thread\-Helper\-::notify\-Error(), and reconnect().

\hypertarget{classmdt_port_thread_a97bff8cf6aca37d8858cc4e5c9294cae}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!port@{port}}
\index{port@{port}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{port}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Abstract\-Port} $\ast$ mdt\-Port\-Thread\-::port (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_a97bff8cf6aca37d8858cc4e5c9294cae}


Get port instance. 

\begin{DoxyReturn}{Returns}
Port instance, or a null pointer if it was not set 
\end{DoxyReturn}


Definition at line 65 of file mdt\-Port\-Thread.\-cpp.



References pv\-Port.



Referenced by set\-Port(), and mdt\-Usb\-Port\-Thread\-::set\-Port().

\hypertarget{classmdt_port_thread_abb7234a12814f5c7c98bd6c1c2ccb776}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!read\-Process\-Begin@{read\-Process\-Begin}}
\index{read\-Process\-Begin@{read\-Process\-Begin}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{read\-Process\-Begin}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::read\-Process\-Begin (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_abb7234a12814f5c7c98bd6c1c2ccb776}


Emitted when a read process begins. 

This can be used to display read state. Please consider that this signal is emitted each time the read process begins, and not when it ends. This is because asynch I/\-O calls are fast, and nothing will be seen from user if we update state before/after I/\-O call. To handle this, use this signal as trigger, and hold the state some stime (f.\-ex. 100 \mbox{[}ms\mbox{]}) \hypertarget{classmdt_port_thread_ae71ae3aa58eb1f409a2b128e6ef3148b}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!ready@{ready}}
\index{ready@{ready}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{ready}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::ready (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Port\-Thread} $\ast$}]{thread}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_ae71ae3aa58eb1f409a2b128e6ef3148b}


Emitted when thread is started and ready. 

\hypertarget{classmdt_port_thread_abee1d2f9b67ca37cfd13e108ca978b36}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!reconnect@{reconnect}}
\index{reconnect@{reconnect}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{reconnect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Abstract\-Port\-::error\-\_\-t} mdt\-Port\-Thread\-::reconnect (
\begin{DoxyParamCaption}
\item[{bool}]{notify = {\ttfamily true}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_thread_abee1d2f9b67ca37cfd13e108ca978b36}


Try to reconnect to device/peer. 

This is a helper method for subclass. When a port method returns a Disconnected error, the thread can call this method, wich will try to reconnect (using \hyperlink{classmdt_abstract_port_aec74b2db1a629d98a95d8f042ea96653}{mdt\-Abstract\-Port\-::reconnect()} ) until max retry was reached.

Reconnect timeout and max try are readen from port config, in \hyperlink{classmdt_port_thread_a5a5c1290eaa43182d69c3f39eadbec00}{start()} method.


\begin{DoxyParams}{Parameters}
{\em notify} & If true, error will be notified (with \hyperlink{classmdt_port_thread_ab31cbe1a85aa830cd368654d1f806326}{error\-Occured()} ), and failure after max\-Try will be reported with \hyperlink{classmdt_error}{mdt\-Error}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
No\-Error if reconnection worked or Unhandled\-Error else.
\end{DoxyReturn}
\begin{DoxyPrecond}{Precondition}
Port must be set with \hyperlink{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}{set\-Port()} before using this method. 
\end{DoxyPrecond}


Definition at line 230 of file mdt\-Port\-Thread.\-cpp.



References mdt\-Error\-::commit(), connected(), mdt\-Abstract\-Port\-::\-Connecting, mdt\-Abstract\-Port\-::\-Connection\-Failed, mdt\-Abstract\-Port\-::\-Disconnected, mdt\-Error\-::\-Error, M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, mdt\-Abstract\-Port\-::\-No\-Error, notify\-Error(), pv\-Port, pv\-Running, mdt\-Abstract\-Port\-::reconnect(), mdt\-Abstract\-Port\-::\-Unhandled\-Error, and mdt\-Error\-::\-Warning.

\hypertarget{classmdt_port_thread_abce96e61e09780841b729f28ab9054f0}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!running\-Flag\-Set@{running\-Flag\-Set}}
\index{running\-Flag\-Set@{running\-Flag\-Set}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{running\-Flag\-Set}]{\setlength{\rightskip}{0pt plus 5cm}bool mdt\-Port\-Thread\-::running\-Flag\-Set (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classmdt_port_thread_abce96e61e09780841b729f28ab9054f0}


Get the running flag. 

This method is used by \hyperlink{classmdt_port_thread_helper}{mdt\-Port\-Thread\-Helper} and should not be used directly.

Port's mutex is not handled in this method. 

Definition at line 180 of file mdt\-Port\-Thread.\-cpp.



References pv\-Running.



Referenced by mdt\-Port\-Thread\-Helper\-::get\-New\-Frame\-Read(), mdt\-Port\-Thread\-Helper\-::get\-New\-Frame\-Write(), mdt\-Port\-Thread\-Helper\-::handle\-Common\-Read\-Errors(), mdt\-Port\-Thread\-Helper\-::handle\-Common\-Write\-Errors(), and mdt\-Port\-Thread\-Helper\-Port\-::write\-To\-Port().

\hypertarget{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!set\-Port@{set\-Port}}
\index{set\-Port@{set\-Port}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{set\-Port}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::set\-Port (
\begin{DoxyParamCaption}
\item[{{\bf mdt\-Abstract\-Port} $\ast$}]{port}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}


Set the port instance. 

\begin{DoxyPrecond}{Precondition}
port must be a valid pointer 

The thread must not running 
\end{DoxyPrecond}


Definition at line 57 of file mdt\-Port\-Thread.\-cpp.



References port(), and pv\-Port.



Referenced by mdt\-Port\-Manager\-::add\-Thread(), and mdt\-Usb\-Port\-Thread\-::set\-Port().

\hypertarget{classmdt_port_thread_ad9bcfaa66fba25512f2677a7e320c6c8}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!set\-Running\-Flag@{set\-Running\-Flag}}
\index{set\-Running\-Flag@{set\-Running\-Flag}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{set\-Running\-Flag}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::set\-Running\-Flag (
\begin{DoxyParamCaption}
\item[{bool}]{running}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_ad9bcfaa66fba25512f2677a7e320c6c8}


Set the running flag. 

This method is used by \hyperlink{classmdt_port_thread_helper}{mdt\-Port\-Thread\-Helper} and should not be used directly.

Port's mutex is not handled in this method. 

Definition at line 175 of file mdt\-Port\-Thread.\-cpp.



References pv\-Running.

\hypertarget{classmdt_port_thread_a01d2362e0dfcece4cba242cb586d8d1c}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!sigaction\-Handle@{sigaction\-Handle}}
\index{sigaction\-Handle@{sigaction\-Handle}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{sigaction\-Handle}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::sigaction\-Handle (
\begin{DoxyParamCaption}
\item[{int}]{signum}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}}\label{classmdt_port_thread_a01d2362e0dfcece4cba242cb586d8d1c}


Definition at line 281 of file mdt\-Port\-Thread.\-cpp.



Referenced by mdt\-Port\-Thread().

\hypertarget{classmdt_port_thread_a5a5c1290eaa43182d69c3f39eadbec00}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!start@{start}}
\index{start@{start}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{start}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::start (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_a5a5c1290eaa43182d69c3f39eadbec00}


Start the thread. 

This method will not wait until thread is running and ready. Once thread is ready, \hyperlink{classmdt_port_thread_ae71ae3aa58eb1f409a2b128e6ef3148b}{ready()} signal is emitted.

\begin{DoxyPrecond}{Precondition}
Port instance must be defined. 

Port must have a valid configuration. 
\end{DoxyPrecond}


Definition at line 80 of file mdt\-Port\-Thread.\-cpp.



References mdt\-Abstract\-Port\-::config(), mdt\-Port\-Config\-::connect\-Max\-Try(), mdt\-Port\-Config\-::connect\-Timeout(), pv\-Port, and mdt\-Abstract\-Port\-::\-Unhandled\-Error.

\hypertarget{classmdt_port_thread_a5746ea96689ed80179751ad1353f0b39}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!stop@{stop}}
\index{stop@{stop}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{stop}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::stop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classmdt_port_thread_a5746ea96689ed80179751ad1353f0b39}


Stop the running thread. 

This method will not wait until thread is stopped. Once thread is stopped, \hyperlink{classmdt_port_thread_a4266192826f09d8186ee8f9b646ac089}{finished()} signal is emitted.

\begin{DoxyPrecond}{Precondition}
Port instance must be defined with \hyperlink{classmdt_port_thread_acd51474c3a2683676423317bc9cb31b2}{set\-Port()}. 
\end{DoxyPrecond}


Reimplemented in \hyperlink{classmdt_port_write_thread_a69702ab3a95c238fb451f866efc7cb34}{mdt\-Port\-Write\-Thread}.



Definition at line 92 of file mdt\-Port\-Thread.\-cpp.



References mdt\-Abstract\-Port\-::abort\-Frame\-To\-Write\-Wait(), mdt\-Error\-::commit(), mdt\-Error\-::\-Error, is\-Writer(), mdt\-Abstract\-Port\-::lock\-Mutex(), M\-D\-T\-\_\-\-E\-R\-R\-O\-R\-\_\-\-S\-E\-T\-\_\-\-S\-R\-C, M\-D\-T\-\_\-\-P\-O\-R\-T\-\_\-\-I\-O\-\_\-\-E\-R\-R\-O\-R, pv\-Native\-Pthread\-Object, pv\-Port, pv\-Running, mdt\-Error\-::set\-System\-Error(), mdt\-Abstract\-Port\-::\-Unhandled\-Error, and mdt\-Abstract\-Port\-::unlock\-Mutex().



Referenced by mdt\-Port\-Write\-Thread\-::stop(), and $\sim$mdt\-Port\-Thread().

\hypertarget{classmdt_port_thread_a621c0748a16bc9ee15983ef488314c85}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!wait\-Finished@{wait\-Finished}}
\index{wait\-Finished@{wait\-Finished}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{wait\-Finished}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::wait\-Finished (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_a621c0748a16bc9ee15983ef488314c85}


Wait until thread is finished. 

This is a conveniance method, mainly used by test suite. Port manager, for example, use the finished signal ensteatd of this method. 

Definition at line 148 of file mdt\-Port\-Thread.\-cpp.



References is\-Finished(), and msleep.

\hypertarget{classmdt_port_thread_aca7473f73c6b68fe8c3e1cfc349240e7}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!wait\-Ready@{wait\-Ready}}
\index{wait\-Ready@{wait\-Ready}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{wait\-Ready}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::wait\-Ready (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classmdt_port_thread_aca7473f73c6b68fe8c3e1cfc349240e7}


Wait until thread is ready. 

This is a conveniance method, mainly used by test suite. Port manager, for example, use the ready signal ensteatd of this method. 

Definition at line 139 of file mdt\-Port\-Thread.\-cpp.



References is\-Running(), and msleep.

\hypertarget{classmdt_port_thread_aa01aac7e1a26deb823be40e6cb01b255}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!write\-Process\-Begin@{write\-Process\-Begin}}
\index{write\-Process\-Begin@{write\-Process\-Begin}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{write\-Process\-Begin}]{\setlength{\rightskip}{0pt plus 5cm}void mdt\-Port\-Thread\-::write\-Process\-Begin (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [signal]}}}\label{classmdt_port_thread_aa01aac7e1a26deb823be40e6cb01b255}


Emitted when a write process begins. 

This can be used to display write state. Please consider that this signal is emitted each time the write process begins, and not when it ends. This is because asynch I/\-O calls are fast, and nothing will be seen from user if we update state before/after I/\-O call. To handle this, use this signal as trigger, and hold the state some stime (f.\-ex. 100 \mbox{[}ms\mbox{]}) 

\subsection{Member Data Documentation}
\hypertarget{classmdt_port_thread_a7154af7d387eecaea113ddb5900ff23c}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!pv\-Native\-Pthread\-Object@{pv\-Native\-Pthread\-Object}}
\index{pv\-Native\-Pthread\-Object@{pv\-Native\-Pthread\-Object}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{pv\-Native\-Pthread\-Object}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-t mdt\-Port\-Thread\-::pv\-Native\-Pthread\-Object\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_thread_a7154af7d387eecaea113ddb5900ff23c}


Definition at line 270 of file mdt\-Port\-Thread.\-h.



Referenced by mdt\-Port\-Thread(), and stop().

\hypertarget{classmdt_port_thread_af5c4bed0c9fb012f220fba013d0f69b8}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!pv\-Port@{pv\-Port}}
\index{pv\-Port@{pv\-Port}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{pv\-Port}]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdt\-Abstract\-Port}$\ast$ mdt\-Port\-Thread\-::pv\-Port\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_thread_af5c4bed0c9fb012f220fba013d0f69b8}


Definition at line 264 of file mdt\-Port\-Thread.\-h.



Referenced by detach\-Port(), is\-Finished(), is\-Running(), mdt\-Port\-Thread(), port(), reconnect(), set\-Port(), start(), mdt\-Port\-Write\-Thread\-::stop(), and stop().

\hypertarget{classmdt_port_thread_a59735ef01b761361b1055a0356be525a}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!pv\-Running@{pv\-Running}}
\index{pv\-Running@{pv\-Running}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{pv\-Running}]{\setlength{\rightskip}{0pt plus 5cm}volatile bool mdt\-Port\-Thread\-::pv\-Running\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_thread_a59735ef01b761361b1055a0356be525a}


Definition at line 263 of file mdt\-Port\-Thread.\-h.



Referenced by is\-Finished(), is\-Running(), mdt\-Port\-Thread(), reconnect(), running\-Flag\-Set(), mdt\-Usb\-Port\-Thread\-::send\-Control\-Query(), set\-Running\-Flag(), stop(), and mdt\-Usb\-Port\-Thread\-::wait\-On\-Control\-Transfer\-Possible().

\hypertarget{classmdt_port_thread_ae22f83fd56b06cdaa9b77abafe85a6b4}{\index{mdt\-Port\-Thread@{mdt\-Port\-Thread}!pv\-Sigaction@{pv\-Sigaction}}
\index{pv\-Sigaction@{pv\-Sigaction}!mdtPortThread@{mdt\-Port\-Thread}}
\subsubsection[{pv\-Sigaction}]{\setlength{\rightskip}{0pt plus 5cm}struct sigaction mdt\-Port\-Thread\-::pv\-Sigaction\hspace{0.3cm}{\ttfamily [protected]}}}\label{classmdt_port_thread_ae22f83fd56b06cdaa9b77abafe85a6b4}


Definition at line 271 of file mdt\-Port\-Thread.\-h.



Referenced by mdt\-Port\-Thread().



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/mdtport/\hyperlink{mdt_port_thread_8h}{mdt\-Port\-Thread.\-h}\item 
src/mdtport/\hyperlink{mdt_port_thread_8cpp}{mdt\-Port\-Thread.\-cpp}\end{DoxyCompactItemize}
