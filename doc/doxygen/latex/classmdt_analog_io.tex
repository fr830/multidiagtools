\hypertarget{classmdt_analog_io}{
\section{mdtAnalogIo Class Reference}
\label{classmdt_analog_io}\index{mdtAnalogIo@{mdtAnalogIo}}
}


Representation of a analog I/O.  




{\ttfamily \#include $<$mdtAnalogIo.h$>$}



Inheritance diagram for mdtAnalogIo:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=158pt]{classmdt_analog_io__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for mdtAnalogIo:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=158pt]{classmdt_analog_io__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classmdt_analog_io_aa2c2fb87d67aad7bbba1b488cc8c1df2}{setValue} (const \hyperlink{classmdt_value}{mdtValue} \&value, bool emitValueChanged=false)
\begin{DoxyCompactList}\small\item\em Set the value to update display. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classmdt_analog_io_aa81b49605f601850ecfa780f2b758e98}{
void {\bfseries unitChangedForUi} (const QString \&unit)}
\label{classmdt_analog_io_aa81b49605f601850ecfa780f2b758e98}

\item 
\hypertarget{classmdt_analog_io_a40735cbbf852790067a6f9b57aac4aa3}{
void {\bfseries rangeChangedForUi} (double min, double max)}
\label{classmdt_analog_io_a40735cbbf852790067a6f9b57aac4aa3}

\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classmdt_analog_io_affcdf039a10023b495cf49a5f476f829}{
{\bfseries mdtAnalogIo} (QObject $\ast$parent=0)}
\label{classmdt_analog_io_affcdf039a10023b495cf49a5f476f829}

\item 
\hypertarget{classmdt_analog_io_afb4cd82bee1ac1e77148c8621b1c66fa}{
void \hyperlink{classmdt_analog_io_afb4cd82bee1ac1e77148c8621b1c66fa}{setUnit} (const QString \&unit)}
\label{classmdt_analog_io_afb4cd82bee1ac1e77148c8621b1c66fa}

\begin{DoxyCompactList}\small\item\em Set the unit (V, A, Â°C, ...) \end{DoxyCompactList}\item 
\hypertarget{classmdt_analog_io_a126d5b9bf4a0bb9ce9f2ff6a010fef0e}{
QString \hyperlink{classmdt_analog_io_a126d5b9bf4a0bb9ce9f2ff6a010fef0e}{unit} () const }
\label{classmdt_analog_io_a126d5b9bf4a0bb9ce9f2ff6a010fef0e}

\begin{DoxyCompactList}\small\item\em Get unit. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_analog_io_ab5733c8d4f49da6e6d4f11f1e1aa9555}{setRange} (double min, double max, int intValueBitsCount, int intValueLsbIndex=0, bool intValueSigned=false)
\begin{DoxyCompactList}\small\item\em Specify the range of values and bits decode parameters. \end{DoxyCompactList}\item 
bool \hyperlink{classmdt_analog_io_a2263d9b0bf2c1b998386c590866f06e8}{setEncodeBitSettings} (int intValueBitsCount, int intValueLsbIndex)
\begin{DoxyCompactList}\small\item\em Set the bits encode parammeters. \end{DoxyCompactList}\item 
\hypertarget{classmdt_analog_io_acd2b8cb33d5d42abf23672ad7675825e}{
double \hyperlink{classmdt_analog_io_acd2b8cb33d5d42abf23672ad7675825e}{minimum} () const }
\label{classmdt_analog_io_acd2b8cb33d5d42abf23672ad7675825e}

\begin{DoxyCompactList}\small\item\em Get the minimum value of the range. \end{DoxyCompactList}\item 
\hypertarget{classmdt_analog_io_a61e312bc7921a6ca097ea6babf3281a5}{
double \hyperlink{classmdt_analog_io_a61e312bc7921a6ca097ea6babf3281a5}{maximum} () const }
\label{classmdt_analog_io_a61e312bc7921a6ca097ea6babf3281a5}

\begin{DoxyCompactList}\small\item\em Get the maximum value of the range. \end{DoxyCompactList}\item 
void \hyperlink{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}{setValueInt} (int value, bool isValid, bool emitValueChanged)
\begin{DoxyCompactList}\small\item\em Set the integer value. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Representation of a analog I/O. 

On wide range of automation applications, it is usefull to display a I/O to the user. For example, a analog I/O module, with a 8 bit encoding could be displayed with this class togther with \hyperlink{classmdt_analog_in_widget}{mdtAnalogInWidget} or \hyperlink{classmdt_analog_out_widget}{mdtAnalogOutWidget}. 

Definition at line 35 of file mdtAnalogIo.h.



\subsection{Member Function Documentation}
\hypertarget{classmdt_analog_io_a2263d9b0bf2c1b998386c590866f06e8}{
\index{mdtAnalogIo@{mdtAnalogIo}!setEncodeBitSettings@{setEncodeBitSettings}}
\index{setEncodeBitSettings@{setEncodeBitSettings}!mdtAnalogIo@{mdtAnalogIo}}
\subsubsection[{setEncodeBitSettings}]{\setlength{\rightskip}{0pt plus 5cm}bool mdtAnalogIo::setEncodeBitSettings (
\begin{DoxyParamCaption}
\item[{int}]{intValueBitsCount, }
\item[{int}]{intValueLsbIndex}
\end{DoxyParamCaption}
)}}
\label{classmdt_analog_io_a2263d9b0bf2c1b998386c590866f06e8}


Set the bits encode parammeters. 

On many analog output module, it is possible to set a value, and read it. It can happen that the bitmap differs between write and read (f.ex. Wago 750-\/550). In such case, a alternate bits count and lsb index can be set here.

Note that \hyperlink{classmdt_analog_io_ab5733c8d4f49da6e6d4f11f1e1aa9555}{setRange()} will overwrite thiese settings.


\begin{DoxyParams}{Parameters}
{\em intValueBitsCount} & Number of bits used for the value, including sign bit. (has only effect when using valueInt() ). \\
\hline
{\em intValueLsbIndex} & Index of first bit to use for value extraction. (has only effect when using valueInt() ).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true on success. Some checks are done, and if one fails, false is returned and the previous settingsare used for conversion. 
\end{DoxyReturn}


Definition at line 120 of file mdtAnalogIo.cpp.

\hypertarget{classmdt_analog_io_ab5733c8d4f49da6e6d4f11f1e1aa9555}{
\index{mdtAnalogIo@{mdtAnalogIo}!setRange@{setRange}}
\index{setRange@{setRange}!mdtAnalogIo@{mdtAnalogIo}}
\subsubsection[{setRange}]{\setlength{\rightskip}{0pt plus 5cm}bool mdtAnalogIo::setRange (
\begin{DoxyParamCaption}
\item[{double}]{min, }
\item[{double}]{max, }
\item[{int}]{intValueBitsCount, }
\item[{int}]{intValueLsbIndex = {\ttfamily 0}, }
\item[{bool}]{intValueSigned = {\ttfamily false}}
\end{DoxyParamCaption}
)}}
\label{classmdt_analog_io_ab5733c8d4f49da6e6d4f11f1e1aa9555}


Specify the range of values and bits decode parameters. 

Store the new range and set the value to the minimum. The \hyperlink{classmdt_abstract_io_a43feaa62996af78f64aea084122f1370}{valueChanged()} signal is emitted.

It can happen that a I/O module returns, f.ex., a integer value in a 16 bits packet, but with some additional flags. (example: Wago 750-\/457). In such case, the value is, f.ex., encoded in 12 bits only.

Take example of Wago 750-\/457:
\begin{DoxyItemize}
\item Value + flags are encoded in a 16 bits word
\item Value is encoded in 12 bits, from b3 to b14 + 1 sign bit, b15
\item Value is scaled from -\/10 V to 10 V
\end{DoxyItemize}

In this example, this method must be called with min = -\/10.0 , max = 10.0 , intValueBitsCount = 13 , intValueLsbIndex = 3 and intValueSigned = true .

Note that some analog output hardware use a different resolution for read and write (f.ex. Wago 750-\/550). In such case, you can set parameters for reading here, and use \hyperlink{classmdt_analog_io_a2263d9b0bf2c1b998386c590866f06e8}{setEncodeBitSettings()} for alternate parameters for write.


\begin{DoxyParams}{Parameters}
{\em min} & Minimum value to display (f.ex. 0V, or 4mA) \\
\hline
{\em max} & Maximum value to display (f.ex. 10V, or 20mA) \\
\hline
{\em intValueBitsCount} & Number of bits used for the value, including sign bit. (has only effect when using \hyperlink{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}{setValueInt()} ). \\
\hline
{\em intValueLsbIndex} & Index of first bit to use for value extraction. (has only effect when using \hyperlink{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}{setValueInt()} ). \\
\hline
{\em intValueSigned} & If true, decoded value is considered as signed value, i.e. the most significant bit is the sign. (has only effect when using \hyperlink{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}{setValueInt()} ).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true on success. Some checks are done, and if one fails, false is returned and the previous settingsare used for conversion.
\end{DoxyReturn}
\begin{DoxyPrecond}{Precondition}
max must be $>$ min
\end{DoxyPrecond}
Note for UI developpers:
\begin{DoxyItemize}
\item The signal rangeChangedForUi() is emited
\item The signal \hyperlink{classmdt_abstract_io_a0241183736b9bc3abb021868b9bf4273}{valueChangedForUi()} is emited 
\end{DoxyItemize}

Definition at line 60 of file mdtAnalogIo.cpp.

\hypertarget{classmdt_analog_io_aa2c2fb87d67aad7bbba1b488cc8c1df2}{
\index{mdtAnalogIo@{mdtAnalogIo}!setValue@{setValue}}
\index{setValue@{setValue}!mdtAnalogIo@{mdtAnalogIo}}
\subsubsection[{setValue}]{\setlength{\rightskip}{0pt plus 5cm}void mdtAnalogIo::setValue (
\begin{DoxyParamCaption}
\item[{const {\bf mdtValue} \&}]{value, }
\item[{bool}]{emitValueChanged = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual, slot\mbox{]}}}}
\label{classmdt_analog_io_aa2c2fb87d67aad7bbba1b488cc8c1df2}


Set the value to update display. 

\begin{DoxySeeAlso}{See also}
\hyperlink{classmdt_abstract_io_a3f5fc9ed13c2ec2aad0987cd15d95e31}{mdtAbstractIo::setValue(const mdtValue\&, bool)} 
\end{DoxySeeAlso}


Reimplemented from \hyperlink{classmdt_abstract_io_a3f5fc9ed13c2ec2aad0987cd15d95e31}{mdtAbstractIo}.



Definition at line 181 of file mdtAnalogIo.cpp.

\hypertarget{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}{
\index{mdtAnalogIo@{mdtAnalogIo}!setValueInt@{setValueInt}}
\index{setValueInt@{setValueInt}!mdtAnalogIo@{mdtAnalogIo}}
\subsubsection[{setValueInt}]{\setlength{\rightskip}{0pt plus 5cm}void mdtAnalogIo::setValueInt (
\begin{DoxyParamCaption}
\item[{int}]{value, }
\item[{bool}]{isValid, }
\item[{bool}]{emitValueChanged}
\end{DoxyParamCaption}
)}}
\label{classmdt_analog_io_a2b1fb3fd25580c4e470f1962f7640750}


Set the integer value. 

Will calculate the real value depending on resolution and update display. The resolution is set with \hyperlink{classmdt_analog_io_ab5733c8d4f49da6e6d4f11f1e1aa9555}{setRange()} (intValueBitsCount parameter)

The \hyperlink{classmdt_abstract_io_a43feaa62996af78f64aea084122f1370}{valueChanged()} signal is emitted.


\begin{DoxyParams}{Parameters}
{\em value} & The value to store \\
\hline
{\em isValid} & The validity flag. This flag is later avaliable with \hyperlink{classmdt_abstract_io_a61d96045087fe92a0b455693970b1e76}{mdtAbstractIo::hasValidData()} \\
\hline
{\em emitValueChanged} & If true, \hyperlink{classmdt_abstract_io_a43feaa62996af78f64aea084122f1370}{valueChanged()} will not be emitted\\
\hline
\end{DoxyParams}
Note for UI developpers:
\begin{DoxyItemize}
\item The signal \hyperlink{classmdt_abstract_io_a0241183736b9bc3abb021868b9bf4273}{valueChangedForUi()} is emited 
\end{DoxyItemize}

Definition at line 170 of file mdtAnalogIo.cpp.



The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/mdtutils/mdtAnalogIo.h\item 
src/mdtutils/mdtAnalogIo.cpp\end{DoxyCompactItemize}
